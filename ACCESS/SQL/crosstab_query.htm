<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Crosstab Query and adjusting Fixed Column Headings</title>

<style>
<!--
A.type1:link    {color:#0033CC; text-decoration:none;}
A.type1:visited {color:#0033CC; text-decoration:none;}
A.type1:active  {color:#0033CC; text-decoration:none;}
A.type1:hover   {color:#800000; text-decoration:underline;}

A.type2:link    {color:#800000; text-decoration:none;}
A.type2:visited {color:#800000; text-decoration:none;}
A.type2:active  {color:#800000; text-decoration:none;}
A.type2:hover   {color:#0033CC; text-decoration:underline;}

A.type3:link    {color:#0033CC; text-decoration:none;}
A.type3:visited {color:#0033CC; text-decoration:none;}
A.type3:active  {color:#0033CC; text-decoration:none;}
A.type3:hover   {color:#800000; text-decoration:overline underline;}
//-->
</style>


<style type="text/css">
body {scrollbar-3dlight-color:#000000;
scrollbar-arrow-color:#FFFFFF;
scrollbar-base-color:#ffffff;
scrollbar-darkshadow-color:#000000;
scrollbar-face-color:#660000;
scrollbar-highlight-color:#ffffff;
scrollbar-shadow-color:#ffffff}
</style>

<style>
	table.includes {border-top:1px solid #ccc}
	table.includes td {font:normal 11px sans-serif; border-bottom: 1px solid #ccc; padding:10px}
	a {color: #0033FF}
	a:hover {color:#660000}
	h1 {font-size:12px; margin:0 0 5px 0}
	ul.list {list-style-image: url(''); padding:0; margin-left:15px; margin-right:0; margin-top:0; margin-bottom:0}
	ul.list li {margin: 2px 0;}
</style>

<style>
	table.bottom_links {margin:10px 0px}
	table.bottom_links td {padding:3px}
</style>


<script type="text/javascript">
<!--
  if (top.location != location) {top.location.href = document.location.href ;}
-->
</script>


<style>
<!--
.new_link {color: #000000;  font-family: Verdana, Arial, Helvetica, sans-serif;   font-size: 11px; text-decoration: none; font-weight: normal;}
-->
</style>
</head>

<BODY background="../YellowTexture.gif">
<table border="0" width="100%" cellspacing="0" cellpadding="0" id="table146">
	<tr>
		<td>
	<font style="font-size: 6pt">&nbsp;</font></td>
	</tr>
</table>



<table border="0" width="100%" cellspacing="0" cellpadding="0" id="table7">
	<tr>
		<td>
	<p align="center"><font face="Verdana" style="font-size: 80%">
	<a class="type3" href="../../index.htm">Home</a>&nbsp;|
	<a class="type3" href="../../AboutMe/Me.htm">About me</a> |
	<a class="type1" href="../../VBA/beginner_basic.htm">EXCEL VB Programming (XL97-2003)</a>&nbsp;|
	<a style="color: #800000; text-decoration: none" href="../beginner_basic_Acc.htm">ACCESS Programming</a>&nbsp;|
	<a class="type1" href="../../EXCEL/excel_under_construction.htm">EXCEL VB.Net Programming</a>&nbsp;|
	<a class="type1" href="../../EXCEL/excel_worksheet_functions.htm">EXCEL Spreadsheet Functions</a> |&nbsp;
	<a class="type1" href="../../INVENTORY%20MGMT/index_inv_mgmt.htm">Material&nbsp; Management</a>&nbsp;|
	<a class="type1" href="../../GUESTBOOK/gbook.php">Guestbook</a></font>
	<font size="1">&nbsp;</font><hr color="#0066FF" size="1"></td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b><font size="5" face="Arial">Crosstab</font><font size="5"><font face="Arial"> Query Example 1</font></font><font size="4"> </font></b>
<font size="4" face="Arial">[<a href="Past%20Sales.mdb">download</a>&nbsp; database]</font></p>
<p><font face="Arial">This is how the raw data looks like. Notice that there are 
duplicate part numbers. It is because the parts were sold in different periods, 
as you can see the dates and qty sold were not the repeating for the similar 
part numbers. This is difficult to read and we need some form of a 
cross-tabulation. Crosstab query will do just this. </font></p>
<p><img border="0" src="data_before_crosstabQry.gif" width="445" height="246"></p>
<p>&nbsp;</p>
<p><font face="Arial">You will do the following steps to complete the crosstab query 
without using the crosstab wizard dialog box. You can have up to 3 Row Headings, 
and only allowed one Column Heading. </font></p>
<p><font face="Arial">1. Add the table 'Past6MonthsSales' to the query grid.<br>
2. Use the Query Type drop-down list to select Crosstab Query.<br>
3. Add the field PartNumber as the Row Heading, add 'DateSold' as the Column 
Heading and use interval datatype for the , the 3rd field using the SUM 
aggregate function to compute the Values, and finally use the LIKE operator, for 
this example, to include only those part numbers where they don't end with a 
suffix B. Then run your query. </font></p>
<p><img border="0" src="crosstab_query.gif" width="730" height="356"></p>
<p>&nbsp;</p>
<p><font face="Arial">This is the result after running the above crosstab query. Now 
there are no repeating part numbers, the 6 months were pivoted to the columns, 
and also the sum values of parts sold over the time periods. If you don't use 
fixed column headings, all the columns are included in the query output in 
alphabetical order as you can see in the diagram below. By using fixed column 
headings, you can tell Access to re-arrange the order of the columns in the 
query result.</font></p>
<p><img border="0" src="data_after_crosstabQry.gif" width="483" height="298"></p>
<p>&nbsp;</p>
<p><font face="Arial">To go to fixed column headings, place your cursor on the date 
field 'DateSold', then click on the Properties icon in the toolbar, or simply 
just right-click on the date field. Next it will bring out the field query 
Properties box.</font></p>
<p>
<img border="0" src="crosstab_query_field_properties01.gif" width="700" height="393"></p>
<p>&nbsp;</p>
<p><font face="Arial">In the Column Headings field, type in the order of the 
month-year periods that you want them to appear in the query result. In this 
example, I want it to appear in such sequence from 2006 Jan to Mar, then from 
2005 Oct to Dec. Close the Properties box after you are done and run the query 
again.</font></p>
<p>
<img border="0" src="crosstab_query_field_properties02.gif" width="562" height="286"></p>
<p>&nbsp;</p>
<p><font face="Arial">Now you see Access re-arranged the time periods to appear just 
as the order that I wanted. Take note if you type in the different header names, 
there will be no data appear in the query result. If you type in only some 
correct column header names, you will be shown only query result for those few 
columns that you had specified.</font></p>
<p>
<img border="0" src="crosstab_query_adjustedFieldProperties.gif" width="491" height="302"></p>
<p>&nbsp;</p>
<p><font face="Arial">In SQL VIEW, this is what it looks like.</font></p>
<p><img border="0" src="sqlView_crosstabQry.gif" width="599" height="151"></p>

</body>

</html>
