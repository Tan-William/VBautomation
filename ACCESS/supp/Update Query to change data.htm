<html>


<!-- Mirrored from vbautomation.110mb.com/ACCESS/supp/Update%20Query%20to%20change%20data.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:57:39 GMT -->
<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Update Query to change data in o</title>
</head>




<style>
	table.includes {border-top:1px solid #ccc}
	table.includes td {font:normal 11px sans-serif; border-bottom: 1px solid #ccc; padding:10px}
	a {color: #0033FF}
	a:hover {color:#660000}
	h1 {font-size:12px; margin:0 0 5px 0}
	ul.list {list-style-image: url(../../../www.newmail.ru/pics/channels/a1.gif); margin:0 0 0 15px; padding:0}
	ul.list li {margin: 2px 0;}
</style>
<style>
	table.bottom_links {margin:10px 0px}
	table.bottom_links td {padding:3px}
</style>





<!-- Mirrored from vbautomation.110mb.com/ACCESS/supp/Update%20Query%20to%20change%20data.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:57:39 GMT -->
<head>
<style type="text/css">
#dhtmltooltip{
position: absolute;
width: 150px;
border: 1px solid black;
padding: 2px;
background-color: lightyellow;
visibility: hidden;
z-index: 100;
font-type: arial;
font-size: 14;
/*Remove below line to remove shadow. Below line should always appear last within this CSS*/
filter: progid:DXImageTransform.Microsoft.Shadow(color=gray,direction=135);
}
</style>
</head>



<body>
<div id="dhtmltooltip"></div>
<script type="text/javascript">
/************************************************************
* Cool DHTML tooltip script provided by www.dynamicdrive.com
*************************************************************/
var offsetxpoint=-60 //Customize x offset of tooltip
var offsetypoint=20 //Customize y offset of tooltip
var ie=document.all
var ns6=document.getElementById && !document.all
var enabletip=false
if (ie||ns6)
var tipobj=document.all? document.all["dhtmltooltip"] : document.getElementById? document.getElementById("dhtmltooltip") : ""

function ietruebody(){
return (document.compatMode && document.compatMode!="BackCompat")? document.documentElement : document.body
}
function ddrivetip(thetext, thecolor, thewidth){
if (ns6||ie){
if (typeof thewidth!="undefined") tipobj.style.width=thewidth+"px"
if (typeof thecolor!="undefined" && thecolor!="") tipobj.style.backgroundColor=thecolor
tipobj.innerHTML=thetext
enabletip=true
return false
}
}
function positiontip(e){
if (enabletip){
var curX=(ns6)?e.pageX : event.clientX+ietruebody().scrollLeft;
var curY=(ns6)?e.pageY : event.clientY+ietruebody().scrollTop;
//Find out how close the mouse is to the corner of the window
var rightedge=ie&&!window.opera? ietruebody().clientWidth-event.clientX-offsetxpoint : window.innerWidth-e.clientX-offsetxpoint-20
var bottomedge=ie&&!window.opera? ietruebody().clientHeight-event.clientY-offsetypoint : window.innerHeight-e.clientY-offsetypoint-20

var leftedge=(offsetxpoint<0)? offsetxpoint*(-1) : -1000

//if the horizontal distance isn't enough to accomodate the width of the context menu
if (rightedge<tipobj.offsetWidth)
//move the horizontal position of the menu to the left by it's width
tipobj.style.left=ie? ietruebody().scrollLeft+event.clientX-tipobj.offsetWidth+"px" : window.pageXOffset+e.clientX-tipobj.offsetWidth+"px"
else if (curX<leftedge)
tipobj.style.left="5px"
else
//position the horizontal position of the menu where the mouse is positioned
tipobj.style.left=curX+offsetxpoint+"px"

//same concept with the vertical position
if (bottomedge<tipobj.offsetHeight)
tipobj.style.top=ie? ietruebody().scrollTop+event.clientY-tipobj.offsetHeight-offsetypoint+"px" : window.pageYOffset+e.clientY-tipobj.offsetHeight-offsetypoint+"px"
else
tipobj.style.top=curY+offsetypoint+"px"
tipobj.style.visibility="visible"
}
}
function hideddrivetip(){
if (ns6||ie){
enabletip=false
tipobj.style.visibility="hidden"
tipobj.style.left="-1000px"
tipobj.style.backgroundColor=''
tipobj.style.width=''
}
}
document.onmousemove=positiontip
</script>






<table border="0" width="89%" cellspacing="0" cellpadding="0" id="table1">
	<tr>
		<td width="22">&nbsp;</td>
		<td>
		<table width="956" border="0" cellspacing="1">
			<tr class="navbar">
				<td valign="bottom" align="center">
				<p class="nav" align="left">
				<font face="Verdana" style="font-size: 75%">
				<span style="text-decoration: none">&nbsp;&nbsp;
				<a href="../../index.htm"><span style="text-decoration: none">
				Home</span></a></span>&nbsp; |&nbsp;
				<a href="../../VBA/beginner_basic.htm">
				<span style="text-decoration: none">EXCEL VBA</span>
				<span style="text-decoration: none">(XL97-2003)</span></a>&nbsp; 
				|&nbsp; <span style="text-decoration: none">
				<a href="../../EXCEL/excel_under_construction.htm">
				<span style="text-decoration: none">EXCEL VB.Net</span></a></span>&nbsp; 
				|&nbsp; <a href="../beginner_basic_Acc.htm">
				<span style="text-decoration: none">ACCESS VBA</span></a>&nbsp; 
				|&nbsp; <a href="../../EXCEL/excel_worksheet_functions.htm">
				<span style="text-decoration: none">EXCEL Spreadsheet Functions</span></a>&nbsp; 
				|&nbsp; <a href="../../INVENTORY%20MGMT/index_inv_mgmt.htm">
				<span style="text-decoration: none">Material Management </span>
				</a>&nbsp;|&nbsp; <a href="../../AboutMe/Me.htm">
				<span style="text-decoration: none">About me</span></a><br>
&nbsp;</font></td>
	
	
	
	<script type="text/javascript">
<!--
  if (top.location != location) {top.location.href = document.location.href ;}
-->
</script>


				<style>
<!--
.new_link {color: #000000;  font-family: Verdana, Arial, Helvetica, sans-serif;   font-size: 11px; text-decoration: none; font-weight: normal;}
-->
</style>
<!-- default document font and size -->
<!-- end default tags -->
<!-- start language tags -->
<!-- end language tags -->
<!-- start document specific tags -->
<!-- document last updated -->
<!-- end document specific tags -->

				<style type="text/css">
body {scrollbar-3dlight-color:#000000;
scrollbar-arrow-color:#FFFFFF;
scrollbar-base-color:#ffffff;
scrollbar-darkshadow-color:#000000;
scrollbar-face-color:#339933;
scrollbar-highlight-color:#ffffff;
scrollbar-shadow-color:#ffffff}
</style>
			</tr>
		</table>
		</td>
	</tr>
	<tr>
		<td width="22">&nbsp;</td>
		<td>
		<table class="OTbl" cellSpacing="0" cellPadding="0" width="100%" id="table2">
			<tr>
				<td class="cdONBodyCellUnpadded">
				<table class="OTbl" cellSpacing="0" cellPadding="0" width="100%" id="table3">
					<tr>
						<td class="ACB" style="padding-left: 12px; padding-right: 12px; padding-top: 10px; padding-bottom: 10px" width="100%" colSpan="3">
						<b><font face="Arial" style="font-size: 20pt"><a name=backtotop></a>Update 
						Query to change data in one or more tables</font></b><p>
						<font size="2" face="Arial">The how-to sections in this page uses the 
						Northwind Traders sample database. If you do not have a 
						copy installed in your PC, you can download it from here 
						[<a href="../examples/NorthWind.zip"><font color="#0033FF">DOWNLOAD</font></a>].</font></p>
						<p><b><font face="Arial"><a href="#0">
						<font color="#0066CC">Overview</font></a></font></b><font size="2" face="Arial"><br>
						Provides background information about update queries, 
						including when to use them and when to use other tools, 
						such as a Delete query, Append and Make-Table queries.
						</font></p>
						<p>
						<b><span style="font-family: Arial"><a href="#1">
						<font color="#0066CC">Update data in one 
						or more fields</font></a></span></b><span style="font-family: Arial"><br>
						<font size="2">Explains the basics of creating and running an update 
						query against one or more fields in a single table. The 
						section also explains how to test your update criteria 
						by first creating a select query, and then converting 
						that select query to an update query.</font></span></p>
						<p><b><span style="font-family: Arial"><a href="#2">
						<font color="#0066CC">Use data from 
						multiple tables to create an update query</font></a></span></b><span style="font-family: Arial"><br>
						<font size="2">Explains how to build an update query that uses fields 
						from two or more tables.</font></span></p>
						<p><b><span style="font-family: Arial"><a href="#3">
						<font color="#0066CC">Change data in 
						multiple tables</font></a></span></b><span style="font-family: Arial"><br>
						<font size="2">Explains how to create an update query that changes 
						data in more than one table. Subsections explain how 
						improper query design can produce unwanted results.</font></span></p>
						<p><b><span style="font-family: Arial"><a href="#4">
						<font color="#0066CC">Update the data 
						in one table by using data from another table</font></a></span></b><span style="font-family: Arial"><br>
						<font size="2">Explains how to use an update query that takes data from 
						one table and writes it to records in another table.</font></span></p>
						<p><b><span style="font-family: Arial"><a href="#5">
						<font color="#0066CC">Various ways to 
						use update queries</font></a></span></b><span style="font-family: Arial"><br>
						<font size="2">Individual sections explain how to perform a variety of 
						tasks: How to &quot;blank out&quot; fields by setting them to 
						Null, how to add data to Null fields, how to use 
						parameters in connection with update queries, and how to 
						use wildcard characters in your select and update 
						queries.</font></span></p>
						<p>&nbsp;</p>
						<p><b><font size="5"><span style="font-family: Arial">
						<a name="0"></a>Overview</span></font></b><font size="2"><br>
						<font face="Arial">Microsoft Office Access 2003 provides 
						several ways to change the data in a database. For 
						example, you can open a table or the results of a select 
						query in Datasheet view — a row and column grid similar 
						to a Microsoft Office Excel 2003 worksheet — and change 
						your data manually. But what do you do when you need to 
						change a large number of records, especially when those 
						records must meet one or more criteria? You use an 
						update query.</font></font></p>
						<p><font size="2" face="Arial">You can think of update 
						queries as a more powerful version of the Find and 
						Replace dialog box. Your update queries contain select 
						criteria (the equivalent of a search string) and update 
						criteria (the equivalent of a replacement string). The 
						query finds all records that match your select criteria, 
						and then writes your update criteria to those records, 
						all in one pass.</font></p>
						<p><font size="2" face="Arial">However, your select and 
						update criteria can be much more powerful than ordinary 
						search and replacement strings, because your criteria 
						can contain expressions (expression: Any combination of 
						mathematical or logical operators, constants, functions, 
						and names of fields, controls, and properties that 
						evaluates to a single value. Expressions can perform 
						calculations, manipulate characters, or test data.) and 
						calculations. For example, your select criteria could 
						find all products that have a discount of 20 percent or 
						greater, and your update criteria could change those 
						discounts to a different percentage that you specify.
						</font></p>
						<p><font size="2" face="Arial">In addition, your update 
						queries can use multiple select and update criteria. To 
						continue the previous example, you could find all 
						products that have discounts of 20 percent, 18 percent, 
						or 15 percent, and reduce these discounts to 15 percent, 
						12 percent, and 10 percent, respectively — something 
						that you cannot do with other tools. </font></p>
						<p><font size="2" face="Arial">This topic explains how 
						to use update queries to perform a variety of tasks, 
						such as changing Yes values to No values, inserting data 
						into blank fields, and changing values in more than one 
						table simultaneously. The how-to steps do not assume 
						that you're familiar with update queries, and they 
						provide any expressions that are needed to accomplish 
						the task being demonstrated. As you proceed, remember 
						that an update query is not the same thing as what is 
						called an updatable query. An updatable query is another 
						type of query (a select query) that displays its results 
						in a datasheet, and that allows you to change the data 
						in that datasheet manually. In contrast, update queries 
						do not display a datasheet when they finish running.
						</font></p>
						<p><font size="2" face="Arial">Note Remember that you 
						use update queries only on existing data. If you want to 
						insert new records or delete whole records, you must use 
						different query types or other tools. If you want to 
						copy records from one table to another, you must create 
						an <font color="#0066CC">Append query</font>. If you want to delete entire records 
						from a database, you must create a Delete query. If you 
						want to delete entire records from a database, you must 
						create a <font color="#0066CC">Delete query</font> (but remember that if you want to 
						remove only part of a record, you must use an
						<font color="#0066CC">Update 
						query</font>). If you want to create a table from the records 
						that are returned by another query, you can create a
						<font color="#0066CC">Make-Table query</font>.</font></p>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to 
						top</a> &gt;</b></font></p>
						<p>&nbsp;</p>
						<p><b><font size="5"><span style="font-family: Arial">
						<a name=1></a>Update data in one or more fields</span></font></b></p>
						<p><font face="Arial" size="2">The steps in these sections 
						explain how to change values in one or more fields in a 
						single table. Remember that you can not undo the results 
						of an update query, so backing up your database 
						beforehand is a very good idea.</font></p>
						<p><font face="Arial" size="2">The steps in this section use the 
						Northwind Traders sample database, but you can adapt the 
						steps for use with your own data. For information about 
						opening and using the sample database, see the section 
						Open the Northwind Traders sample database, also earlier 
						in this topic.</font></p>
						<p><font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;The safest way to use 
						an update query is to first create a select query that 
						tests your selection criteria. For example, say that you 
						want to update a series of Yes/No fields from
						<b class="bterm">No</b> to <b class="bterm">Yes</b> for 
						a given customer. To do so, you add criteria to your 
						select query until it returns all of the desired
						<b class="bterm">No</b> records for that customer. When 
						you're sure that you have the correct records, you 
						convert your select query to an update query, enter your 
						update criteria, and then run the query to update the 
						selected values. Whenever possible, the how-to sections 
						in this topic begin with select queries, and then 
						convert those queries to update queries.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses 
							the Orders table in the Northwind Traders sample 
							database. </font></li>
							<li><font face="Arial" size="2">In the upper pane of the 
							Query Designer, select the <b class="bterm">OrderID</b> 
							field (in Orders table), <b class="bterm">ProductID</b> 
							field (in Products table), and <b class="bterm">
							Discount</b> field (in Order Details table), and 
							drag them to the query design grid. </font></li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> 
							field below <b class="bterm">Discount</b>, type <b>
							&gt;0.2</b>. (Remember to enter the decimal point, 
							because you're dealing with a percentage value. That 
							value returns all products that have a discount rate 
							greater than 20 percent).</font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							. If you're using the Northwind Traders database, 
							Access returns 154 records.</font></li>
						</ol>
						<p><font face="Arial" size="2">When you're sure you have the data 
						that you want to change, convert your select query to an 
						update query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Click <b class="ui">Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return the query to Design view. </font></li>
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> 
							menu, click <b class="ui">Update Query</b>. </font>
							<p><font face="Arial" size="2">Access converts your select 
							query to an update query, and adds the <b class="ui">
							Update To</b> field to the Query Designer.</font></li>
							<li><font face="Arial" size="2">In the <b class="ui">Update 
							To</b> field under <b class="ui">Discount</b>, type 
							the desired value&nbsp;— in this case, <b>0.22</b> </font>
							<p><font face="Arial" size="2">Leave the original expression 
							(<b class="bterm">&gt;.20</b>) in the <b class="ui">
							Criteria</b> field. If you remove it, the update 
							query will change every record in the table, 
							including those that have no discount applied.</font></p>
							<p><font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;To change the 
							data in more than one field, enter update criteria 
							for each of the fields that you want to change. You 
							can specify update criteria for some or all the 
							fields in the query design grid. Keep in mind that 
							your update criteria must match the data type 
							assigned to the fields that you want to update. For 
							example, you can't replace the value in a Yes/No 
							field with text.</font></li>
							<li><font face="Arial" size="2">To run the query and update 
							the records, click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							. </font></li>
							<li><font face="Arial" size="2">After you run the update 
							query and are alerted to confirm the operation, 
							click <b class="ui">Yes</b>. </font>
							<p><font face="Arial" size="2">Access runs the query and 
							updates the records, but you won't see the datasheet 
							with the updated data yet.</font></li>
							<li><font face="Arial" size="2">To see the results of your 
							update query, click <b class="ui">View</b>
							<img border="0" src="../images/view.gif" width="21" height="20"> 
							on the Query Design toolbar. </font>
							<p><font face="Arial" size="2">Note that even though you 
							included the OrderID and ProductID fields in the 
							original select query, Access removed them when you 
							ran the update operation. By default, Access removes 
							all fields that do not contain update criteria. If 
							you want to see the additional fields, convert your 
							query back to a select query and run it again, but 
							use <b class="bterm">0.22</b> as your select 
							criteria.</font></li>
						</ol>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to 
						top</a> &gt;</b></font></p>
						<p>&nbsp;</p>
						<h2><font face="Arial"><a name="2"></a>Use data from multiple tables to create an update 
						query</font></h2>
						<p><font face="Arial" size="2">The following steps explain how to create an update 
						query that searches for a set of products and marks them 
						as unavailable. The steps assume that you have backed up 
						your database.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses the Products and 
							Suppliers tables in the Northwind Traders sample 
							database. </font>
							</li>
							<li><font face="Arial" size="2">In the Query Designer, drag the <b class="bterm">
							SupplierID</b> field from the Suppliers table to the 
							grid, and then drag the <b class="bterm">SupplierID</b>,
							<b class="bterm">ProductName</b> and
							<b class="bterm">Discontinued</b> fields from the 
							Products table to the design grid.
							</font>
							<p><font face="Arial" size="2">For either table, you can hold down CTRL while 
							you select each field, and then drag the fields to 
							the design grid simultaneously.</font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							. The query returns 77 records. Scroll down the list 
							of records, and make a note of the Supplier ID 
							number assigned to Pavlova Ltd. You'll use that ID 
							in the following procedure.</font></li>
						</ol>
						<p><font face="Arial" size="2">Next, you enter criteria to locate a single supplier. 
						Once you locate the data that you want to change, you 
						can convert your select query into an update query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the main toolbar, click <b class="ui">Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return the query to Design view.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							the first instance of SupplierID, type
							<b class="bterm">7</b> (the ID for Pavlova Ltd.), 
							and then click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query again.
							</font>
							<p><font face="Arial" size="2">The query returns five records, and you can see 
							that one product, Alice Mutton, is already 
							discontinued.</font></li>
						</ol>
						<p><font face="Arial" size="2">At this point, you can manually select the
						<b class="ui">Discontinued</b> check box for each 
						record, but assume instead that you're looking at a 
						large number of records, and that you need to convert 
						the existing select query into an update query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Click <b class="ui">Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return the query to Design view again.
							</font>
							</li>
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Update Query</b>.
							</font>
							<p><font face="Arial" size="2">Access converts your select query to an update 
							query, and adds the <b class="ui">Update To</b> 
							field to the Query Designer.</font></li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under
							<b class="ui">Discontinued</b>, enter
							<b class="bterm">Yes</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">To run the query and update the records, click
							<b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							.
							</font>
							<p><font face="Arial" size="2">When you run the query, an alert message says 
							that Access will update all five rows, even though 
							one of those rows already contains a
							<b class="bterm">Yes</b> value.</font></li>
							<li><font face="Arial" size="2">In this case, the update operation won't change 
							the existing value, so click <b class="ui">Yes</b> 
							to run the query.
							</font>
							<p><font face="Arial" size="2">If you did not want to overwrite the existing 
							value, you could enter <b class="ui">No</b> in the
							<b class="ui">Criteria</b> field below the
							<b class="ui">Update To</b> field, as shown in the 
							following illustration.</font></p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateto.gif" width="160" height="114"></font></p>
							<p><font face="Arial" size="2">That additional constraint forces the update 
							query to change only those records that contain a
							<b class="bterm">No</b> value.</font></p>
							<p><font face="Arial" size="2">Access runs the query and updates the records, 
							but you won't see the datasheet with the updated 
							data yet.</font></li>
							<li><font face="Arial" size="2">To see the results of your update query, click
							<b class="ui">View</b>
							<img border="0" src="../images/view.gif" width="21" height="20"> 
							on the Query Design toolbar.
							</font>
							<p><font face="Arial" size="2">Notice that even though you included the 
							ProductID, ProductName, and SupplierID fields in the 
							original select query, Access removed them when you 
							ran the update operation. By default, Access removes 
							all fields unless either they contain update 
							criteria or the update operation changes them. If 
							you want to see the data that was originally in your 
							select query, convert your update query back to a 
							select query, and then run it again.</font></li>
						</ol>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to top</a> &gt;</b></font></p>
						<p>&nbsp;</p>
						<h2><font face="Arial"><a name="3"></a>Change data in multiple tables</font></h2>
						<p><font face="Arial" size="2">In a properly designed database (a database in third 
						normal form), the tables share a set of <b>one-to-many</b> 
						relationships. For example, in the Northwind Traders 
						database, all data for suppliers resides in one table, 
						and all data for products resides in another. Because a 
						supplier can provide multiple products, a <b>one-to-many</b> 
						relationship exists between the Suppliers and Products 
						tables. If you want to change the supplier data for a 
						given set of products, you only need to change that data 
						on the &quot;one&quot; side of the relationship&nbsp;— in the Suppliers 
						table.</font></p>
						<p><font face="Arial" size="2">For that reason, you don't usually need to update 
						data in multiple tables by running an update query, 
						although you can if you need to.</font></p>
						<p><font face="Arial" size="2">An update query that produces unwanted results</font></p>
						<p><font face="Arial" size="2">The steps in this section show you how an update 
						query can produce unwanted results when you change a 
						record on the &quot;one&quot; side of a one-to-many relationship. 
						In this example, you need to locate a specific order and 
						change the name of the employee who took the order:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Start a new query that uses the Orders and 
							Employees tables in the Northwind Traders database.
							</font>
							</li>
							<li><font face="Arial" size="2">Drag the <b class="bterm">EmployeeID</b>,
							<b class="bterm">FirstName</b>, and <b class="bterm">
							LastName</b> fields from the Employees table to the 
							design grid, and then drag the <b class="bterm">
							EmployeeID</b> and <b class="bterm">OrderID</b> 
							fields from the Orders table to the design grid.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under
							<b class="ui">LastName</b>, type <b>Buchanan</b>
							</font>
							</li>
							<li><font face="Arial" size="2">Under <b class="bterm">FirstName</b>, type <b>
							Steven</b>
							</font>
							</li>
							<li><font face="Arial" size="2">Clear the <b class="ui">Show</b> check box under 
							the EmployeeID field for the Orders table. </font>
							</li>
							<li><font face="Arial" size="2">Under OrderID, type <b>10248</b>
							</font>
							<p><font face="Arial" size="2">Your query should look similar to the one in the 
							following illustration (though your fields don't 
							need to be in the order shown here).. </font> </p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateQuery_1.gif" width="350" height="233"></font></p>
							<p><font face="Arial" size="2">If you click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							and test the query, it returns one record for order 
							number 10248.</font></li>
						</ol>
						<p><font face="Arial" size="2">Once you successfully test your criteria in the 
						select query, you convert it to an update query and 
						change your data:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">If you tested the query, click <b class="ui">
							Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return it to Design view and then, on the
							<b class="ui">Query</b> menu, click <b class="ui">
							Update Query</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field, under 
							LastName, type <b>Stahl</b>
							</font>
							</li>
							<li><font face="Arial" size="2">Under FirstName, type <b>Annik</b>
							</font>
							<p><font face="Arial" size="2">Your query should look like the one in the 
							following illustration.</font></p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateQuery_2.gif" width="350" height="233"></font></p>
							<p>&nbsp;</li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							, and then click <b class="ui">Yes</b> when asked to 
							confirm the update operation. The query updates one 
							row.</font></li>
						</ol>
						<p><font face="Arial" size="2">On the surface, everything about the update query 
						seems fine. Your select query returned one record, and 
						the update query updated that one record. The problem 
						is, you updated the employee record on the &quot;one&quot; side of 
						the relationship, and that change affected every order 
						for that employee on the &quot;many&quot; side of the 
						relationship. The following steps show how to see the 
						impact of the change:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Select Query</b>, and then run the 
							query again.
							</font>
							<p><font face="Arial" size="2">The query does not return any results.</font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return the query to Design view .
							</font>
							</li>
							<li><font face="Arial" size="2">Replace <b class="bterm">Buchanan</b> with <b>
							Stahl</b> and replace <b class="bterm">Steven</b> 
							with <b>Annik</b> and then run the query again.
							</font>
							<p><font face="Arial" size="2">The query returns one record, for order number 
							10248.</font></li>
							<li><font face="Arial" size="2">Go back to Design view one last time, clear
							<b class="bterm">10248</b> from the <b class="ui">
							Criteria</b> field, and then run the query a final 
							time.</font></li>
						</ol>
						<p><font face="Arial" size="2">The query returns 42 records for Annik Stahl, and all 
						of those records used to belong to Steven Buchanan. Even 
						though you only wanted to change one record, you updated 
						the wrong field in a <b>one-to-many</b> relationship, 
						and your change affected all related records. The steps 
						in the next section explain how to run an update query 
						that produces a usable result.</font></p>
						<p><font face="Arial" size="2">An update query that produces correct results</font></p>
						<p><font face="Arial" size="2">The previous section showed you how changing a record 
						on the &quot;one&quot; side of a <b>one-to-many</b> relationship 
						can cause unwanted changes to a large number of records. 
						The following steps explain how to update records in two 
						tables on the &quot;one&quot; side of relationships without making 
						that mistake. In this scenario, one of your suppliers 
						has been sold to another company. You need to change the 
						company name and the name of one product. Because it's a 
						good habit to get into, you start with a select query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Start a new query that uses the Products and 
							Suppliers tables in the Northwind Traders database.
							</font>
							</li>
							<li><font face="Arial" size="2">Drag the <b class="bterm">ProductID</b> and
							<b class="bterm">ProductName</b> fields from the 
							Products table to the design grid, and then drag the
							<b class="bterm">SupplierID</b> and <b class="bterm">
							CompanyName</b> fields from the Suppliers table to 
							the grid.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							CompanyName/Suppliers, type <b>Exotic Liquids</b>
							</font>
							<p><font face="Arial" size="2">Your query should look like the one in the 
							following illustration.</font></p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateQuery_3.gif" width="331" height="90"></font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to test the query.
							</font>
							<p><font face="Arial" size="2">The query returns three records.</font></li>
						</ol>
						<p><font face="Arial" size="2">Once you've used the select query to confirm that 
						you're using the right criteria (Exotic Liquids, in this 
						case), you build your update query. This update query 
						uses the same approach as the query in the previous 
						section&nbsp;— it changes records on the &quot;one&quot; side of <b>
						one-to-many</b> relationships. In this case, it changes 
						a supplier name and a product name, but without 
						affecting a large number of records:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Click <b class="ui">Design</b>
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return the query to Design view and then, on the
							<b class="ui">Query</b> menu, click <b class="ui">
							Update Query</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under
							<b class="bterm">ProductName</b>, type <b>Exotic 
							Chai</b>
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under
							<b class="bterm">ProductName</b>, type <b>Chai</b>
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under
							<b class="bterm">CompanyName</b>, type the new 
							supplier name, <b>Contoso Exotics</b>
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field directly 
							below <b class="bterm">CompanyName</b>, type the old 
							supplier name, <b>Exotic Liquids</b>
							</font>
							<p><font face="Arial" size="2">Your query should look like the one in the 
							following illustration.</font></p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateQuery_4.gif" width="332" height="75"></font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query, and then, when Access asks you to 
							confirm a change to one record, click <b class="ui">
							Yes</b>. 
							</font> 
							<p><font face="Arial" size="2">The query changes <b class="bterm">Exotic Liquids</b> 
							to <b class="bterm">Contoso Exotics</b> in the 
							Suppliers table (on the &quot;one&quot; side of the 
							relationship), and it changes <b class="bterm">Chai</b> 
							(in the Products table) to <b class="bterm">Exotic 
							Chai</b>.</font></li>
						</ol>
						<p><font face="Arial" size="2">To see how changing the values in the two tables 
						affected the data, go on to the following steps.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Select</b> to convert the query back 
							to a select query. 
							</font> 
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under
							<b class="ui">SupplierID</b>, type <b>1</b> and then 
							run the query.
							</font>
							<p><font face="Arial" size="2"><b class="bterm">Exotic Liquids</b> is now
							<b class="bterm">Contoso Exotics</b>, and
							<b class="bterm">Chai</b> is now <b class="bterm">
							Exotic Chai</b>. In this case, changing the 
							CompanyName field on the &quot;one&quot; side of the 
							relationship properly cascaded the change through 
							the related records.</font></li>
							<li><font face="Arial" size="2">Go back to the Database window, select the Order 
							Details table, and then create a new select query 
							that uses that table.
							</font>
							</li>
							<li><font face="Arial" size="2">Drag the OrderID and ProductID fields to the 
							query design grid.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							ProductID, type <b>1</b> (the product ID for Exotic 
							Chai), and then run the query. </font>
							<p><font face="Arial" size="2">You can see that every order for <b class="bterm">
							Chai</b> has now changed to reflect the new product 
							name.</font></li>
						</ol>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to top</a> &gt;</b></font></p>
						<p>&nbsp;</p>
						<h2><font face="Arial"><a name="4"></a>Update the data in one table by using data from 
						another table</font></h2>
						<p><font face="Arial" size="2">At times, you may need to update the data in one 
						table by using data from another table. For example, say 
						that you get a table of sales data from the Southwest 
						sales region, and you need to update a table in a global 
						sales database by using that new data.</font></p>
						<p><font face="Arial" size="2">Keep the following facts in mind when you update one 
						table by using data from another table:</font></p>
						<ul xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Ensure that the fields in the source table and 
							in the target table use the same data type. For 
							example, you can't copy dates to an OLE Object 
							field. Fields from different tables can have names 
							that are not identical, but their data types must 
							match. Also, the update query will not change any of 
							the field names in the source or destination tables.
							</font>
							</li>
							<li><font face="Arial" size="2">If the source and target tables do not share a 
							relationship, you need to create a join. 
							</font> 
							</li>
							<li><font face="Arial" size="2">Create a select query that tests your initial 
							selection criteria, and then convert the select 
							query into an update query. In the <b class="ui">
							Update To</b> fields in the update query, you use 
							the following syntax: <b class="bterm">[<i>tablename</i>].[<i>fieldname</i>]</b>, 
							where <b class="bterm">[<i>tablename</i>]</b> is the 
							name of the source table, and <b class="bterm">[<i>fieldname</i>]</b> 
							is the name of the field that you want to copy to 
							the destination table.</font></li>
						</ul>
						<p><font face="Arial" size="2">The steps in the following sections explain how to 
						duplicate a table, change some records in the duplicated 
						table, join that table to its original in a query, and 
						then run an update query that copies records. Start by 
						copying one of the tables in the Northwind Traders 
						database and changing some of the records. The changed 
						records become sample data for use in your update query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">In the Database window, under <b class="ui">
							Objects</b>, click <b class="ui">Tables</b>. 
							</font> 
							</li>
							<li><font face="Arial" size="2">Right-click the Suppliers table and then click
							<b class="ui">Save As</b>. The <b class="ui">Save As</b> 
							dialog box appears.</font></li>
							<li><font face="Arial" size="2">Name the copied table <b class="bterm">
							Suppliers2</b> and ensure that the <b class="ui">As</b> 
							list contains <b class="ui">Table</b>, then click
							<b class="ui">OK</b> to create a copy of the 
							Suppliers table. The copied table appears in the 
							Database window.</font></li>
							<li><font face="Arial" size="2">Open the Suppliers2 table in Datasheet view.
							</font>
							</li>
							<li><font face="Arial" size="2">In the first record (which has a Supplier ID of
							<b class="bterm">1</b>) change the values in the 
							Address, City, Region, and Postal Code fields. (You 
							can change these values to any values that you 
							want).</font></li>
							<li><font face="Arial" size="2">Do the same for the third, sixth, and ninth 
							records, and then close the table.</font></li>
						</ol>
						<p><font face="Arial" size="2">You'll use the Suppliers2 table as the source table 
						for the update query. But first, test the criteria in a 
						select query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses the Suppliers and 
							Suppliers2 tables in the Northwind Traders database. 
							The Suppliers and Suppliers2 tables do not share 
							either a relationship or a join, so you need to 
							create a join and build a select query.</font></li>
							<li><font face="Arial" size="2">On the main toolbar, click <b class="ui">Tools</b> 
							and then click <b class="ui">Relationships</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">In the Suppliers2 table, click the
							<b class="bterm">SupplierID</b> column, drag it to 
							the Suppliers table, and drop it on the
							<b class="bterm">SupplierID</b> column in that 
							second table. (Access creates a join, and indicates 
							the join with a line).</font></li>
							<li><font face="Arial" size="2">In the Suppliers table, drag the
							<b class="bterm">SupplierID</b>, <b class="bterm">
							Address</b>, <b class="bterm">City</b>,
							<b class="bterm">Region</b>, and <b class="bterm">
							PostalCode</b> fields to the design grid.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under
							<b class="ui">SupplierID</b>, type <b class="bterm">
							1 or 3 or 6 or 9</b>
							</font>
							<p><font face="Arial" size="2">These are the IDs of the fields that you changed 
							in the Suppliers2 table.</font></li>
							<li><font face="Arial" size="2">On the main toolbar, click <b class="ui">View</b>
							<img border="0" src="../images/view.gif" width="21" height="20"> 
							to preview the query.
							</font>
							<p><font face="Arial" size="2">The records in the query should match the records 
							that you changed in the previous section. If not, 
							click Design
							<img border="0" src="../images/design.gif" width="21" height="20"> 
							to return to Design view, and then adjust your 
							criteria until they return the correct records.</font></li>
						</ol>
						<p><font face="Arial" size="2">Once your select query returns the correct records, 
						you convert it to an update query and add the table and 
						field names, using the syntax provided at the beginning 
						of this section:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Update Query</b> to convert your 
							select query to an update query.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> fields under 
							Address, City, Region, and PostalCode, enter the 
							corresponding table and field names from the 
							Suppliers2 table. Your finished query should look 
							something like this: </font>
							<table id="table9" width="725" cellspacing="0" border="1" bordercolor="#008080" cellpadding="0">
								<tr>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td width="101">&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td width="108">&nbsp;</td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Field:</font></td>
									<td><font face="Arial" size="2">SupplierID</font></td>
									<td width="101"><font face="Arial" size="2">Address</font></td>
									<td><font face="Arial" size="2">City</font></td>
									<td><font face="Arial" size="2">Region</font></td>
									<td width="108"><font face="Arial" size="2">PostalCode</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Table:</font></td>
									<td><font face="Arial" size="2">Suppliers</font></td>
									<td width="101"><font face="Arial" size="2">Suppliers</font></td>
									<td><font face="Arial" size="2">Suppliers</font></td>
									<td><font face="Arial" size="2">Suppliers</font></td>
									<td width="108"><font face="Arial" size="2">Suppliers</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Update To:</font></td>
									<td>&nbsp;</td>
									<td width="101"><font face="Arial" size="2">[Suppliers2].[Address]</font></td>
									<td><font face="Arial" size="2">[Suppliers2].[City]</font></td>
									<td><font face="Arial" size="2">[Suppliers2].[Region]</font></td>
									<td width="108"><font face="Arial" size="2">[Suppliers2].[PostalCode]</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Criteria:</font></td>
									<td><font face="Arial" size="2">1 Or 3 Or 6 Or 9&nbsp;</font></td>
									<td width="101">&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td width="108">&nbsp;</td>
								</tr>
							</table>
							</li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query.
							</font>
							</li>
							<li><font face="Arial" size="2">When Access asks you to confirm the update for 
							four records, click <b class="ui">Yes</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">Convert your update query back to a select query 
							(leaving the values in the <b class="ui">Criteria</b> 
							field unchanged) to see the changed records in the 
							Suppliers table.</font></li>
						</ol>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to top</a> &gt;</b></font></p>
						<p>&nbsp;</p>
						<font face="Arial">
						<a id="WaysToUse" name="WaysToUse"></a>
						</font>
						<h2><font face="Arial"><a name="5"></a>Various ways to use update queries</font></h2>
						<p><font face="Arial" size="2">The following sections demonstrate some additional 
						ways to use update queries. The sections explain how to 
						&quot;blank out&quot; a field by setting its values to
						<b class="bterm">Null</b>, and how to do just the 
						opposite&nbsp;— how to add values to <b class="bterm">Null</b> 
						or empty fields. Additional sections explain how to add 
						or delete a few characters in a field, how to use 
						parameters in connection with update queries, and how to 
						use wildcard characters in your select and update 
						queries.</font></p>
						<p><font face="Arial" size="2">&quot;Blank out&quot; a field (set the values in a field to 
						Null or enter zero-length strings)</font></p>
						<p><font face="Arial" size="2">You can use an update query to &quot;blank out&quot; a field by 
						setting its values to <b class="bterm">Null</b> or by 
						changing its values to zero-length strings. The 
						following procedure shows how to perform both tasks.</font></p>
						<p><font face="Arial" size="2">You can set fields to <b class="bterm">Null</b>, or 
						enter zero-length strings, for a variety of reasons. In 
						this exercise, one of your suppliers is changing its 
						prices. You don't want to ship any of that supplier's 
						products until you get the new prices, so you set the 
						price values for that supplier's products to
						<b class="bterm">Null</b>. Using null values or 
						zero-length strings stops your database from performing 
						calculations, which in turn stops you from completing 
						and shipping orders. You could set the price values to 
						zero instead, but your database can still use a zero 
						value in calculations, so by using <b class="bterm">Null</b> 
						you ensure that you don't ship orders by mistake.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses the Products and 
							Suppliers tables in the Northwind Traders database.
							</font>
							</li>
							<li><font face="Arial" size="2">Drag the <b class="bterm">SupplierID</b> field 
							from the Suppliers table to the design grid, and 
							then drag the <b class="bterm">SupplierID</b>,
							<b class="bterm">ProductID</b>, <b class="bterm">
							ProductName</b>, and <b class="bterm">UnitPrice</b> 
							fields from the Products table to the grid.
							</font>
							<p><font face="Arial" size="2">Adding the SupplierID fields from both tables 
							gives you all of the information that you need to 
							create your update query. As a rule, it helps to 
							give yourself as much data as possible, because 
							doing so can ensure greater accuracy in the results 
							that your update query produces.</font></li>
							<li><font face="Arial" size="2">Click <b class="ui">View</b>
							<img border="0" src="../images/view.gif" width="21" height="20"> 
							to preview the query, or click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query. The query returns 77 records.</font></li>
							<li><font face="Arial" size="2">Note the supplier ID number for Tokyo Traders (<b class="bterm">4</b>).</font></li>
						</ol>
						<p><font face="Arial" size="2">Now that you have the information needed to set the 
						correct records to <b class="bterm">Null</b>, convert 
						your select query to an update query and then make your 
						changes:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Update</b> to convert the query to an 
							update query.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field, under
							<b class="bterm">SupplierID/Products</b>, type <b>4</b>
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under
							<b class="bterm">UnitPrice</b>, type <b>Null</b> or, 
							to enter zero-length strings, type a pair of double 
							quotes with no space between them (<b class="bterm">&quot;&quot;</b>).
							</font>
							</li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query.
							</font>
							</li>
							<li><font face="Arial" size="2">When Access asks you to confirm the update of 
							three records, click <b class="ui">Yes</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">Convert your update query back to a select 
							query.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							UnitPrice, type <b>Is Null</b> and then run the 
							query.
							</font>
							<p><font face="Arial" size="2">If you entered a zero-length string, type a pair 
							of double quotes with no space between them (<b class="bterm">&quot;&quot;</b>) 
							in the <b class="ui">Criteria</b> field, and then 
							run the query.</font></p>
							<p><font face="Arial" size="2">The query returns all three records for Tokyo 
							Traders, and the UnitPrice field contains no values.</font></li>
							<li><font face="Arial" size="2">Note the product ID numbers for all three 
							products (9, 10, and 74).</font></li>
						</ol>
						<p><font face="Arial" size="2">Leave the query open, and go on to the next section 
						for information about adding data to fields that contain
						<b class="bterm">Null</b> values or zero-length strings.</font></p>
						<p><font face="Arial" size="2">Add data to &quot;empty&quot; or &quot;blank&quot; fields</font></p>
						<p><font face="Arial" size="2">The steps in this section explain how to find fields 
						that contain <b class="bterm">Null</b> values or 
						zero-length strings, and how to add data to those 
						fields. These steps reverse the action that you took in 
						the previous section, and the steps assume that you have 
						left the query from that section open.</font></p>
						<p><font face="Arial" size="2">You can add data to a field that contains
						<b class="bterm">Null</b> values or zero-length strings 
						manually, or by running an update query. The following 
						sections explain how take both actions.</font></p>
						<p><font face="Arial" size="2">Add data to a Null field manually</font></p>
						<ul xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">With the query or table open in Datasheet view 
							(the view that you had open at the end of the 
							previous section), enter the desired value in the 
							fields that contain <b class="bterm">Null</b> values 
							or zero-length strings.
							</font>
							<p><font face="Arial" size="2">For example, if you have the query open from the 
							previous section, you can type <b>97</b> in the 
							UnitPrice fields for Mishi Kobe Niku, <b>31</b> for 
							Ikura, and <b>10</b> for Longlife Tofu. </font> </p>
							<p><font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;You can't update some of the fields 
							when working in Datasheet view.</font></p>
							</li>
						</ul>
						<p><font face="Arial" size="2">Use an update query to add data to Null fields 
						</font> </p>
						<p><font face="Arial" size="2">Depending on your situation, you may find that 
						entering data manually is faster than running an update 
						query.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Return the query from the previous section to 
							Design view.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							ProductID, type <b>9</b> (the Product ID for Mishi 
							Kobe Niku). </font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under 
							UnitPrice, type <b>97</b>
							</font>
							</li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							.
							</font>
							</li>
							<li><font face="Arial" size="2">When Access asks you to confirm the update of 
							one record, click <b class="ui">Yes</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">Repeat steps 2 through 5, but this time type <b>
							10</b> in the <b class="ui">Criteria</b> field and
							<b>31</b> in the <b class="ui">Update To</b> field.
							</font>
							</li>
							<li><font face="Arial" size="2">Repeat steps 2 through 5 again, but this time 
							type <b>74</b> in the <b class="ui">Criteria</b> 
							field and <b>10</b> in the <b class="ui">Update To</b> 
							field.</font></li>
						</ol>
						<p><font face="Arial" size="2">Those steps restore the original price values that 
						the update query in the previous section set to
						<b class="bterm">Null</b>.</font></p>
						<p><font face="Arial" size="2">Use parameters with your update queries</font></p>
						<p><font face="Arial" size="2">You can use a mix of input parameters and update 
						queries whenever doing so makes sense. For example, you 
						can create an input parameter that prompts users for a 
						value, such as a product name. When the user enters the 
						product name and runs the query, the query, in turn, can 
						change a value associated with the product name, such as 
						a price or a discount.</font></p>
						<p><font face="Arial" size="2">The steps in this section explain how to create a 
						query that does just that. The query asks you to input a 
						product name, and it then doubles the price for that 
						product:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses the Products table 
							in the Northwind Traders database. </font>
							</li>
							<li><font face="Arial" size="2">Move the <b class="bterm">ProductName</b> and
							<b class="bterm">UnitPrice</b> fields to the grid, 
							and then either click <b class="ui">View</b>
							<img border="0" src="../images/view.gif" width="21" height="20"> 
							to preview the query, or click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query. The query returns 77 records. Note 
							the unit price for <b class="ui">Chai</b>,
							<b class="bterm">$18.00</b>.</font><p>
							<font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;If 
							you've followed the other exercises in this topic, 
							you may have changed <b class="bterm">Chai</b> to
							<b class="bterm">Exotic Chai</b>. If you have, keep 
							that change in mind, along with the unit price.</font></li>
						</ol>
						<p><font face="Arial" size="2">Next, you convert your query to an update query, and 
						enter a query parameter and expression that changes a 
						unit price.</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">On the <b class="ui">Query</b> menu, click
							<b class="ui">Update</b> to convert the query to an 
							update query.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> field under 
							ProductName, type the following parameter exactly as 
							shown: <b>[Enter Product Name:]</b>
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under 
							UnitPrice, type the following expression exactly as 
							shown: <b>[UnitPrice]*2</b> 
							</font> 
							<p><font face="Arial" size="2">Your finished query should look something like 
							this:</font></p>
							<table id="table10" cellspacing="0" border="1" bordercolor="#008080">
								<tr>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Field:</font></td>
									<td><font face="Arial" size="2">ProductName</font></td>
									<td><font face="Arial" size="2">UnitPrice</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Table:</font></td>
									<td><font face="Arial" size="2">Products</font></td>
									<td><font face="Arial" size="2">Products</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Update To:</font></td>
									<td>&nbsp;</td>
									<td><font face="Arial" size="2">[UnitPrice]*2</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Criteria:</font></td>
									<td><font face="Arial" size="2">[Enter Product Name:]</font></td>
									<td>&nbsp;</td>
								</tr>
							</table>
							</li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query.
							</font>
							<p><font face="Arial" size="2">The <b class="ui">Enter Parameter Value</b> 
							dialog box appears, prompting you to enter a product 
							name.</font></li>
							<li><font face="Arial" size="2">Type <b>Chai</b>&nbsp;— or, if you changed the 
							product name in a previous exercise, type <b>Exotic 
							Chai</b> and then click <b class="ui">OK</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">When Access asks you to confirm the update of 
							one row, click <b class="ui">Yes</b>.</font></li>
						</ol>
						<p><font face="Arial" size="2">If you convert your query back to a select query and 
						run it again, or if you open the Products table in 
						Datasheet view, you can see that the query changed the 
						price of <b class="bterm">Chai</b> from <b class="bterm">
						$18</b> to <b class="bterm">$36</b>.</font></p>
						<p><font face="Arial" size="2">Use wildcard characters in update queries.</font></p>
						<p><font face="Arial" size="2">You can use wildcard characters in update queries, 
						but remember that they work best when used in the
						<b class="ui">Criteria</b> field of the Query Designer. 
						If you use wildcard characters in the <b class="ui">
						Update To</b> field of the Query Designer, Access treats 
						them as literals and writes them to your database&nbsp;— a 
						result that you do not want.</font></p>
						<p><font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;For more information about using 
						wildcard characters, you can see in the Access Help 
						topics: <font color="#0066CC">Find and replace part or 
						all of a record in an Access table, query, or form</font> 
						and <font color="#0066CC">Access wildcard character 
						reference</font>.</font></p>
						<p><font face="Arial" size="2">Finding dates can be one of the harder problems to 
						solve when using wildcard characters. Access stores 
						dates as numbers, but you can apply formatting to those 
						numbers and make the dates fit almost any cultural or 
						geographic preference. For example, a Date/Time field 
						may store a date as <b class="bterm">7/14/1996</b>, but 
						a format can render that same date as <b class="bterm">
						14-Jul-1996</b>. In order to find dates by using 
						wildcard characters, you sometimes need to remove any 
						formatting.</font></p>
						<p><font face="Arial" size="2">The following exercises show you how to query for 
						dates by using wildcard characters, and also how to 
						build an update query from the results of the first 
						query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Create a new query that uses the Orders and 
							Customers tables in the Northwind Traders database.
							</font>
							</li>
							<li><font face="Arial" size="2">From the Orders table, drag the <b class="bterm">
							OrderID</b>, <b class="bterm">CustomerID</b>,
							<b class="bterm">OrderDate</b>, and <b class="bterm">
							RequiredDate</b> fields to the design grid.
							</font>
							</li>
							<li><font face="Arial" size="2">From the Customers table, drag the
							<b class="bterm">CustomerID</b> field to the design 
							grid, and drop it between the existing
							<b class="bterm">CustomerID</b> and <b class="bterm">
							OrderDate</b> fields.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Criteria</b> row, under
							<b class="bterm">OrderDate</b>, type <b>Like &quot;*10*&quot;</b>
							</font>
							<p><font face="Arial" size="2">Your query should look like the one in the 
							following illustration.</font></p>
							<p>
							<font face="Arial" size="2">
							<img border="0" src="../images/updateQuery_5.gif" width="350" height="254"></font></li>
							<li><font face="Arial" size="2">Click <b class="ui">Run</b>
							<img border="0" src="../images/run.gif" width="21" height="20"> 
							to run the query.</font></li>
						</ol>
						<p><font face="Arial" size="2">The query returns records that contain
						<b class="bterm">10</b>, such as <b class="bterm">
						10-Jul-1996</b>, but it also returns records that don't 
						seem to contain <b class="bterm">10</b>, such as
						<b class="bterm">03-Oct-1997</b>. Why? Because in the 
						Gregorian calendar, October is the tenth month, and 
						Access disregards the formatting when you use wildcard 
						characters in a query.</font></p>
						<p><font face="Arial" size="2">Leaving the query open, go on to the next steps to 
						see how removing the format can help you remove the 
						confusion that query results can sometimes cause:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Open the Orders table in Design view.
							</font>
							</li>
							<li><font face="Arial" size="2">Select the OrderDate field.
							</font>
							</li>
							<li><font face="Arial" size="2">On the <b class="ui">General</b> tab (at the 
							bottom of the table design grid), clear the format 
							from the <b class="ui">Format</b> field by 
							highlighting <b class="bterm">dd-mmm-yyyy</b> and 
							then pressing the DELETE key.
							</font>
							</li>
							<li><font face="Arial" size="2">Save your changes, and then close the table 
							design grid.
							</font>
							</li>
							<li><font face="Arial" size="2">Rerun the query that you created in the previous 
							steps.</font></li>
						</ol>
						<p><font face="Arial" size="2">With the format removed, Access displays the values 
						in the Order Date column in the mm/dd/yyyy format, while 
						the date values in the Shipped Date column appear in the 
						dd-mmm-yyyy format. Note that each of the Order Date 
						values returned by the query contains <b class="bterm">
						10</b>. So if a query seems to return unwanted results, 
						try removing any formatting and running the query again.</font></p>
						<p><font face="Arial" size="2">Also, you can use this approach to filter data. For 
						example, the criterion <b class="bterm">Like &quot;10*&quot;</b> 
						returns records only for October, and <b class="ui">Like 
						&quot;*10/1996&quot;</b> returns only orders placed on the tenth 
						day of any month in 1996.</font></p>
						<p><font face="Arial" size="2">Once your original select query returns the correct 
						set of records, you can then create an update query. For 
						this example, suppose that one of your employees 
						imported data for several orders, but set the ship dates 
						incorrectly. The query that you created in the previous 
						steps already provides customer ID numbers, order dates, 
						and ship dates, so the following steps show you how to 
						work with dates in an update query:</font></p>
						<ol xmlns:MSHelp="urn:schemas-microsoft-com:mshelp" xmlns:dates="urn:rdcpro-com:dates" xmlns:bob="urn:bob">
							<li><font face="Arial" size="2">Reopen the query in Design view.
							</font>
							</li>
							<li><font face="Arial" size="2">In the Criteria field under OrderDate, type <b>
							Like &quot;10/*/1997&quot;</b> and then run the query again.
							</font>
							<p><font face="Arial" size="2">The query returns all orders for October of 
							1997&nbsp;— 38 records.</font></p>
							<p><font face="Arial" size="2">Your employee entered incorrect ship dates for 
							three customers&nbsp;— Alfreds Futterkiste, White Clover 
							Markets, and Save-a-Lot Markets.</font></li>
							<li><font face="Arial" size="2">Note the customer IDs for each customer, reopen 
							the query in Design view, and enter each ID in the
							<b class="ui">Criteria</b> field under either of the 
							CustomerID fields&nbsp;— either the one from the Orders 
							table or the one from the Customers table&nbsp;— exactly 
							like this: <b class="bterm">&quot;alfki&quot; or &quot;whitc&quot; or &quot;savea&quot;</b>
							</font>
							<p><font face="Arial" size="2">Make sure you that you include the quotation 
							marks as shown. You don't need to worry about using 
							uppercase and lowercase letters in your criteria, 
							but Access will capitalize each instance of &quot;or&quot;.
							</font>
							</p>
							<p><font face="Arial" size="2"><b>Note</b>&nbsp;&nbsp;You can put each ID on a separate 
							&quot;Or&quot; line in the Query Designer, but if you do so, 
							you also have to copy the date criteria and paste it 
							to each line. The resulting query would look 
							something like this:</font></p>
							<table id="table11" cellspacing="0" border="1" bordercolor="#008080">
								<tr>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Field:</font></td>
									<td><font face="Arial" size="2">OrderID</font></td>
									<td><font face="Arial" size="2">CustomerID</font></td>
									<td><font face="Arial" size="2">CustomerID</font></td>
									<td><font face="Arial" size="2">OrderDate</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Table:</font></td>
									<td><font face="Arial" size="2">Orders</font></td>
									<td><font face="Arial" size="2">Orders</font></td>
									<td><font face="Arial" size="2">Customers</font></td>
									<td><font face="Arial" size="2">Orders</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Sort:</font></td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Show:</font></td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Criteria:</font></td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td><font face="Arial" size="2">ALFKI</font></td>
									<td><font face="Arial" size="2">Like &quot;10/*/1997&quot;</font></td>
								</tr>
								<tr>
									<td><font face="Arial" size="2">Or:</font></td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td><font face="Arial" size="2">WHITC</font></td>
									<td><font face="Arial" size="2">Like &quot;10/*/1997&quot;</font></td>
								</tr>
								<tr>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td><font face="Arial" size="2">SAVEA</font></td>
									<td><font face="Arial" size="2">Like &quot;10/*/1997&quot;</font></td>
								</tr>
							</table>
							</li>
							<li><font face="Arial" size="2">Run the query again.
							</font>
							<p><font face="Arial" size="2">The query returns 10 records. Now you need to 
							change the ship dates.</font></li>
							<li><font face="Arial" size="2">Reopen the query in Design view and then, on the
							<b class="ui">Query</b> menu, click <b class="ui">
							Update</b>.
							</font>
							</li>
							<li><font face="Arial" size="2">In the <b class="ui">Update To</b> field under 
							ShippedDate, type the following expression exactly 
							as shown: <b>[ShippedDate]-1</b>
							</font>
							</li>
							<li><font face="Arial" size="2">Run the query.</font></li>
						</ol>
						<p><font face="Arial" size="2"><b>&lt; <a href="#backtotop">Back to top</a> &gt;</b></font></p>
						<p>&nbsp;</td>
					</tr>
				</table>
				</td>
			</tr>
		</table>
		<p>&nbsp;</td>
	</tr>
</table>

</body>


<!-- Mirrored from vbautomation.110mb.com/ACCESS/supp/Update%20Query%20to%20change%20data.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:57:45 GMT -->
</html>
