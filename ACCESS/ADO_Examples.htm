<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<a name=TOP></a>
<base target="_parent">
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>ADO Examples</title>
<meta name="author" content="William Tan, https://github.com/william-pbTan/VBautomation.git">
<meta name="description" content="Access Macros. Access Visual Basic. Access ADO. Access ADOX. Jet SQL. Access tutorial">
<meta name="keywords" content="Access Macros. Access Visual Basic. Access ADO. Access ADOX. Jet SQL. Access tutorial. Access Help">
<meta name="generator" content="Microsoft FrontPage 12.0">

<style>
<!--
A.type1:link    {color:#0033CC; text-decoration:none;}
A.type1:visited {color:#0033CC; text-decoration:none;}
A.type1:active  {color:#0033CC; text-decoration:none;}
A.type1:hover   {color:#800000; text-decoration:underline;}

A.type2:link    {color:#F06000; text-decoration:none;}
A.type2:visited {color:#F06000; text-decoration:none;}
A.type2:active  {color:#F06000; text-decoration:none;}
A.type2:hover   {color:#0066FF; text-decoration:underline;}

A.type3:link    {color:#0033CC; text-decoration:none;}
A.type3:visited {color:#0033CC; text-decoration:none;}
A.type3:active  {color:#0033CC; text-decoration:none;}
A.type3:hover   {color:#800000; text-decoration:overline underline;}
//-->
</style>

<style type="text/css">
body {scrollbar-3dlight-color:#000000;
scrollbar-arrow-color:#FFFFFF;
scrollbar-base-color:#ffffff;
scrollbar-darkshadow-color:#000000;
scrollbar-face-color:#660000;
scrollbar-highlight-color:#ffffff;
scrollbar-shadow-color:#ffffff}
</style>


<style>
	table.includes {border-top:1px solid #ccc}
	table.includes td {font:normal 11px sans-serif; border-bottom: 1px solid #ccc; padding:10px}
	a {color: #0033FF}
	a:hover {color:#660000}
	h1 {font-size:12px; margin:0 0 5px 0}
	ul.list {list-style-image: url(''); padding:0; margin-left:15px; margin-right:0; margin-top:0; margin-bottom:0}
	ul.list li {margin: 2px 0;}
</style>


<style>
	table.bottom_links {margin:10px 0px}
	table.bottom_links td {padding:3px}
</style>


<body background="YellowTexture.gif">
<table border="0" cellspacing="0" cellpadding="0" id="table63" style="width: 69%">
	<tr>
		<td style="width: 1033px; height: 12px">
	<font style="font-size: 6pt">&nbsp;</font></td>
	</tr>
	<tr>
		<td style="width: 1033px">
	<p class="auto-style13" style="width: 990px; height: 39px;">
	<font style="font-size: 80%" class="auto-style4">
	<a class="type3" href="../index.htm"><span class="auto-style40">Home</span></a><span class="auto-style40"> |
	<a class="type1" href="../VBA/beginner_basic.htm">EXCEL VB Programming (XL97-2003)</a>&nbsp;|
	<a class="type1" style="color: #800000; text-decoration: none" href="beginner_basic_Acc.htm">ACCESS Programming</a>&nbsp;|
	<a class="type1" href="../EXCEL/excel_under_construction.htm">EXCEL VB.Net Programming</a>&nbsp;|
	<a class="type1" href="../EXCEL/excel_worksheet_functions.htm">EXCEL Spreadsheet Functions</a> |&nbsp;<a class="type1" href="../INVENTORY%20MGMT/index_inv_mgmt.htm">Material&nbsp; Management</a>&nbsp;|
	<a class="type1" href="../INVENTORY%20MGMT/production_planning.htm">Master Scheduling &amp; Production Planning</a>&nbsp;|
	<a class="type1" href="../FORECASTING/forecasting_fundamental.htm">Forecasting Methods &amp; Techniques</a>&nbsp;|
	<a class="type3" href="../AboutMe/Me.htm">About me</a>&nbsp;|
	</span>
	<a class="type1" href="../GUESTBOOK/gbook.html"><span class="auto-style40">Guestbook</span></a></font>
	<font size="1">&nbsp;</font><br>
	<font size="1">&nbsp;</font><hr color="#0066FF" size="1" style="height: -15px; width: 983px;" class="auto-style41"></td>
	</tr>
</table>



		</td>
	</tr>
</table>


<style>
<!--
.new_link {color: #000000;  font-family: Verdana, Arial, Helvetica, sans-serif;   font-size: 11px; text-decoration: none; font-weight: normal;}
.auto-style1 {
	font-size: 10.5pt;
}
.auto-style13 {
	text-align: center;
}
.auto-style4 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
}
.auto-style14 {
	color: #000000;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
}
.auto-style15 {
	color: #000000;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
	font-style: italic;
}
.auto-style16 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-weight: bold;
	font-size: 10.5pt;
}
.auto-style17 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
}
.auto-style18 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-weight: bold;
	font-size: 10.5pt;
	text-align: center;
}
.auto-style19 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-weight: bold;
}
.auto-style21 {
	border-width: 0px;
}
.auto-style27 {
	border: 1px solid #999999;
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
	color: #000000;
}
.auto-style28 {
	color: #000000;
}
.auto-style30 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
	border-bottom-style: solid;
	border-bottom-width: 1px;
}
.auto-style31 {
	border: 1px solid #999999;
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
	color: #808000;
}
.auto-style32 {
	border: 1px solid #999999;
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
}
.auto-style36 {
	border-left: 1px solid #999999;
	border-right: 1px solid #999999;
	border-top: 1px none #999999;
	border-bottom: 1px solid #999999;
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
}
.auto-style37 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10.5pt;
	text-align: center;
}
.auto-style38 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 11pt;
}
.auto-style39 {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	font-size: 10pt;
}
.auto-style40 {
	font-size: 11pt;
}
.auto-style41 {
	text-align: center;
	margin-left: 0px;
}
.auto-style42 {
	font-family: Verdana;
	font-weight: bold;
	font-size: 16pt;
}
.auto-style43 {
	color: #0045C3;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
}
-->
</style>
</head>


<TABLE border="0" cellspacing="0" width="994" height="8428" cellpadding="0" background="../YellowTexture.gif">
<font face="">
<tr>
<td bgcolor="#FFFF66" valign="top" align="center" width="169">
		<font face>
		<table bgcolor="#ffff66" border="0" cellpadding="0" cellspacing="0" width="162" height="8415" id="table58">
			<tr>
				<td valign="top" height="8415">
				<table border="0" cellpadding="3" cellspacing="1" width="170" bgcolor="#660033" id="table59">
					<tr>
		<font face>
						<td bgcolor="#660033" height="128" width="162" valign="top">
						<p align="center">
						<img border="0" src="../logo-access.gif" width="162" height="128"></td>
		</font>
					</tr>
					<tr height="35" width="157">
						<td bgcolor="#FFFF66" valign="bottom" width="162" align="left" class="auto-style1">
						<font class="auto-style15"><strong>Access Programming</strong></font><span class="auto-style1">
						</span>                                              
                                                
                    	</td>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" align="left" height="26" class="auto-style1">
						<a rel="internal" class="auto-style14" href="beginner_basic_Acc.htm">Access 
						Database basic</a></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="objects_properties_methods.htm">
						Objects, Collections, Properties and&nbsp; Methods</a></font></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="DoCmd_objects.htm">DoCmd Objects</a></font></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="forms_controls_events.htm">
						Forms, Control and Events</a></font></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
					<font face="Verdana">
					<a rel="internal" class="auto-style14" href="ADO.htm">
					ADO (ActiveX Data Objects)</a></font><span class="auto-style1"></font></font></font></span></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<a rel="internal" class="auto-style43" href="ADO_Examples.htm">ADO 
						examples</font></a></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<a rel="internal" class="auto-style14" href="ADOX.htm">
						ADOX (ADO Extensions)</font></a></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
					<font face="Verdana">
					<a rel="internal" class="auto-style14" href="ADOX_Examples.htm">
					ADOX examples</a></td>
		</font>
					</tr>
					<tr width="157">
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="162" height="26" class="auto-style1">
						<font face="Verdana">
						<a rel="internal" class="auto-style14" href="SQL.htm">
						Jet SQL (Structured Query Language)</a></font></td>
					</tr>
					<tr width="157">
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="SQL_Examples.htm">
		<font face="Verdana">
						Jet SQL examples</font></a></font></td>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="string_manipulation.htm">
						String manipulation</a></font></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<a rel="internal" class="auto-style14" href="Integrating_Access_Excel.htm">
						Integrating Access/Excel</a></td>
		</font>
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						<font face>
						<a rel="internal" class="auto-style14" href="Access2003_VBA_Constants.htm">
						Access 2003 VBA Constants</a></font></td>
		</font>		
					</tr>
					<tr>
		<font face>
						<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#ff9933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="top" width="162" height="26" class="auto-style1">
						&nbsp;</td>
		</font>		
					</tr>
					<tr>
		<font face>
						<td bgcolor="#FFFF66" valign="top" width="162" height="182">
						</td>
		</font>
					</tr>



		<font face>
					</table>
				</td>
			</tr>
			</table>
		</font>
<td valign="top" height="8428" width="4">
      &nbsp;</td>
<td valign="top" height="8428">
      &nbsp;</td>
<td valign="top" height="8428" width="810" style="font-family: Arial; font-size: 10px; color: #000000">
		<p class="auto-style42">Microsoft Access: ADO 
		Programming Code Examples</p>
		<p class="auto-style17">To use the ADO 
		Library, choose References on the Tools menu in the code window, and 
		check the box beside: Microsoft ActiveX Data Objects 2.8 Library or the 
		latest version that you have.</p>
		<table style="BORDER-COLLAPSE: collapse" cellPadding="3" width="91%" border="1" id="table70" bordercolor="#808080">
			<tr class="TableHeadRow">
				<td bgcolor="#000066" class="auto-style18" style="width: 270px">
				<font color="#FFFFFF">Functions</font></td>
				<td bgcolor="#000066">
				<p align="center" class="auto-style16">
				<font color="#FFFFFF">Description</font></td>
			</tr>
			</font>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<font color="#000066">
				<a class="type1" href="#ImportExcelData"><strong>ImportExcelData()</strong></a></font></td>
				<td class="auto-style17">Import Excel data into Access new 
				table using ADO.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ImportData_ExcelObject"><strong>ImportData_ExcelObject()</strong></a></td>
				<td class="auto-style17">Import Excel data into Access new table using Excel Object.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ExportAccessData_ExcelObject"><strong>ExportAccessData_ExcelObject()</strong></a></td>
				<td class="auto-style17">Export Access data into Excel 
				sheet by selected fields, 
				using Excel Object.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#CopyAccessDataToExcel">
				<strong>CopyAccessDataToExcel()</strong></a></td>
				<td class="auto-style17">Export Access data into Excel 
				sheet without using Excel Object.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ADOFSO"><strong>FSOWriteLine()</strong></a></td>
				<td class="auto-style17">Export Access table data to an external text file.</td>
			</tr>
			<tr>
<font face="">
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#CreateView"><strong>CreateView()</strong></a></td>
				<td class="auto-style17">Create a new query using SQL 
				statement and ADO Connection Execute method.</td>
				</font>
			</tr>
			<tr>
<font face="">
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#CreateModifyTable"><strong>CreateModifyTable()</strong></a></td>
				<td class="auto-style17">Modify a query using SQL statement.</td>
				</font>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px"><a class="type1" href="#CreateCommandObject">
				<strong>CreateCommandObject()</strong></a></td>
				<td class="auto-style1">Create Command object using CommandText</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1"href="#CommandTextUpdateProcedure"><strong>CommandTextUpdateProcedure()</strong></a></td>
				<td class="auto-style1">Use CommandText property to update and 
				execute the text of a 
				procedure.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ShowSchema"><strong>OpenSchemaExample()</strong></a></td>
				<td class="auto-style17">List the table names.</td>
			</tr>
			<tr>
<font face="">
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#DeleteRecord_ExecuteMethod"><strong>DeleteRecord_ExecuteMethod()</strong></a></td>
				<td class="auto-style17">Delete records using 
				Execute Method (ADO Connection).</td>
				</font>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#RecordsetOpen"><strong>RecordsetOpen()</strong></a></td>
				<td class="auto-style17">Open a recordset.</td>
			</tr>
			</font>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a  class="type1" href="#RecordsetFind"><strong>RecordsetFind()</strong></a></td>
				</font>
				<td class="auto-style17">Find a record based on a search 
				string.</td>
			</tr>
<font face="">
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a  class="type1" href="#RecordsetSeek"><strong>RecordsetSeek()</strong></a></td>
				<td class="auto-style17">Find a record that matches the 
				specified value.</td>
			</tr>
			</font>
			</font>
			<tr>
				<td height="27" class="auto-style39" style="width: 270px">
				<a  class="type1" href="#AddRecord"><strong>AddRecord()</strong></a></td>
<font face="">
				<td height="27" class="auto-style17">Add new records 
				using recordset.AddNew method.</td>
			</tr>
			</font></font>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#DeleteRecord"><strong>DeleteRecord()</strong></a></td>
<font face="">
				<td class="auto-style17">Delete records using 
				Recordset.Delete method.</td>
			</tr>
			</font></font>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a  class="type1" href="#ReplaceRecord"><strong>ReplaceRecord()</strong></a></td>
<font face="">
				<td class="auto-style17">Explicitly and implicitly call 
				the Update method to change a record's value.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ReplaceAllRecords"><strong>ReplaceAllRecords()</strong></a></td>
				<td class="auto-style17">Update all records using a loop 
				structure.</td>
			</tr>
			<tr>
				<td class="auto-style39" style="width: 270px">
				<a class="type1" href="#ShowMultipleUsers"><strong>ShowMultipleUsers()</strong></a></td>
				<td class="auto-style17">List the users currently 
				connected to the database.</td>
			</tr>
		</table>
		<a name=ImportExcelData></a>
		<p class="section_title">&nbsp;</p>
		<p class="section_title">
		<font color="#000066" size="2" class="auto-style17">Option Compare Database<br>
		</font><font color="#339933" size="2" class="auto-style17">' Setting the HDR 
		field to Yes means that the first row of the worksheet contains column 
		headings.<br>
		' Setting the IMEX field to 1 means that values in columns containing a 
		mixture of text, and numbers should be treated _<br>
&nbsp; as text such as in the case of part numbers. Format Sheet1 as 
		[Sheet1$] so that database driver can locate worksheet name.<br>
		</font>
		<font color="#000066" face="Courier New" size="2" class="auto-style1">
		<br class="auto-style4">
		<span class="auto-style4">Sub ImportExcelData()<br>
		&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#339933"><span class="auto-style17">' Purpose: 
		Import data from Excel with ADO treating Excel worksheet as a database.</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim cn As ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp; Dim InputTbl As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; Dim OutputTbl As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; Dim fld As ADODB.Field<br>
		&nbsp;&nbsp;&nbsp; Dim strSql As String<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set cn = CurrentProject.Connection<br>
		&nbsp;&nbsp;&nbsp; Set InputTbl = New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; InputTbl.ActiveConnection = 
		&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp; &quot;Data Source=D:\Planning\TSL_upload.xls;&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Extended Properties=&quot;&quot;Excel 
		8.0; HDR=YES; IMEX=1&quot;&quot;&quot;<br>
		&nbsp;&nbsp;&nbsp; InputTbl.Open &quot;<b>SELECT</b> * <b>FROM</b> 
		[Sheet1$]&quot;, , adOpenStatic, adLockReadOnly<br>
		&nbsp;&nbsp;&nbsp; </span> </font><span class="auto-style4">
		<font color="#008000" size="2" class="auto-style1">' or you 
		can use a range with a define name, or use a specific address (for 
		example, [Sheet1$A1:G500])<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style17">
		<font color="#008000">' InputTbl.Open &quot;Select * from 
		[Sheet1$A1:G500]&quot;, cn, adOpenStatic</font></span><font color="#000066" face="Courier New" size="2"><span class="auto-style4"><span class="auto-style1"><br>
		<br>
		&nbsp;&nbsp;&nbsp; strSql = &quot;<b>CREATE TABLE</b> tblTSL(Date_Changed date, 
		Part_Number varchar(12) not null,&quot; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&amp; &quot;Std_Cost Money, Old_TSL 
		integer, New_TSL integer not null)&quot;<br>
		&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set OutputTbl = New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; OutputTbl.ActiveConnection = 
		CurrentProject.Connection<br>
		&nbsp;&nbsp;&nbsp; OutputTbl.Open &quot;[tblTSL]&quot;, , adOpenDynamic, 
		adLockOptimistic<br>
		<br>
		&nbsp;&nbsp;&nbsp; Do While Not InputTbl.EOF<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; OutputTbl.AddNew<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; For Each fld In InputTbl.Fields<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; OutputTbl.Fields(fld.Name).Value = fld.Value<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; Next fld<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; OutputTbl.Update<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; InputTbl.MoveNext<br>
		&nbsp;&nbsp;&nbsp; Loop<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set InputTbl = Nothing<br>
		&nbsp;&nbsp;&nbsp; Set OutputTbl = Nothing<br>
		End Sub</span></span></font></p>
		<table border="0" cellspacing="0" cellpadding="0" id="table89" width="765" height="19">
			<tr>
				<td width="765" height="19" valign="top">
				<p align="right">
<font face="">
				<a name=ImportData_ExcelObject></a>
				</font></font>
<font face="Arial" size="2">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
		<hr>
		<p class="auto-style4">
		<font color="#000066" size="2" class="auto-style17">Option Compare Database<br>
		</font></font><font size="2" color="#339933" class="auto-style17">' For this example, you must 
		add reference to the Microsoft Excel 11.0 Object Library.<br>
		' Excel Objects runs Excel application in the background and so is 
		slower than using ADO to read data from Excel. If you are not _<br>
&nbsp;dealing with a lot of data, this approach using Excel objects still works 
		fine.</font></p>
		<p class="section_title">
		<font face="Courier New" size="2" color="#000066">
		<span class="auto-style17">Sub ImportData_ExcelObject()<br>
		&nbsp;&nbsp;&nbsp; </span> <font color="#339933">
		<span class="auto-style17">' Purpose: 
		Import data from Excel using Excel Object library.</span></font><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp; 
		Dim cn As New ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp; 
		Dim outputTbl As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; 
		Dim strSql As String<br>
		&nbsp;&nbsp;&nbsp; 
		Dim i As Long<br>
		&nbsp;&nbsp;&nbsp; 
		Dim ex As Excel.Application<br>
		&nbsp;&nbsp;&nbsp; 
		Dim wb As Excel.WorkBook<br>
		&nbsp;&nbsp;&nbsp; 
		Dim ws As Excel.WorkSheet<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		Set ex = New Excel.Application<br>
		&nbsp;&nbsp;&nbsp; 
		Set wb = ex.Workbooks.Open(&quot;D:\Planning\TSL_upload.xls&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		Set ws = wb.Sheets(&quot;Sheet1&quot;)<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		Set cn = CurrentProject.Connection<br>
		&nbsp;&nbsp;&nbsp; 
		strSql = &quot;<b>CREATE TABLE</b> table_TSL(Date_Changed date, Part_Number 
		varchar(12) not null,&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		&quot;Std_Cost Currency, Old_TSL integer, New_TSL integer not null)&quot;<br>
		&nbsp;&nbsp;&nbsp; 
		cn.Execute strSql<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		Set outputTbl = New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; 
		outputTbl.ActiveConnection = CurrentProject.Connection<br>
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Open &quot;[table_TSL]&quot;, , adOpenDynamic, adLockOptimistic<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		i = 2<br>
		&nbsp;&nbsp;&nbsp; 
		Do While ws.Cells(i, 1) &lt;&gt; &quot;&quot;<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.AddNew<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Fields(0) = ws.Cells(i, 1)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Fields(1) = ws.Cells(i, 2)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Fields(2) = ws.Cells(i, 3)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Fields(3) = ws.Cells(i, 4)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Fields(4) = ws.Cells(i, 5)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		outputTbl.Update<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp; 
		i = i + 1<br>
		&nbsp;&nbsp;&nbsp; 
		Loop<br>
		<br>
		outputTbl.Close<br>
		Set outputTbl = Nothing<br>
		Set ws = Nothing<br>
		wb.Close<br>
		Set wb = Nothing<br>
		Set ex = Nothing<br>
		End Sub</span></span></p>
<font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table90" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right">
<font face="">
				<a name=ExportAccessData_ExcelObject></a>
				</font>
		</font></font>
<font face="Arial" size="2" color="#000066">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
<font face="Courier New" size="2" color="#000066">
		<hr>
		</font>
		<p class="section_title">
		<font color="#000066" size="2" class="auto-style17">Option Compare Database<br>
		</font></font><font size="2" color="#339933" class="auto-style17">' You need to add reference 
		to Microsoft Excel 11.0 Object Library.<br>
		' Because Excel Objects runs Excel application in the background, taking 
		up memory and CPU cycle, and it performs slower than _<br>
&nbsp; using ADO to read data from Excel. Use this example only if you do not 
		have huge data to work on.<br>
		' </font> </font>
		<font color="#000066">
		<span class="auto-style17">
		<font color="#008000">It saves the data into C:\myAccessExport.xls</font></span></p>
		</font>
		<font face="Courier New" size="2" color="#000066">
		<p class="section_title">
		<span class="auto-style17">Sub ExportAccessData_ExcelObject()<br>
&nbsp;&nbsp;&nbsp; </span> <font color="#339933"><span class="auto-style17">' Purpose: 
		Export data from selected table and columns to a new Excel workbook.</span></font><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp;
		Dim rs As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp;
		Dim i As Long<br>
		&nbsp;&nbsp;&nbsp;
		Dim xl As Excel.Application<br>
		&nbsp;&nbsp;&nbsp;
		Dim wb As Excel.WorkBook<br>
		&nbsp;&nbsp;&nbsp;
		Dim ws As Excel.WorkSheet<br>
		&nbsp;&nbsp;&nbsp;
		Dim col As Integer<br>
		&nbsp;&nbsp;&nbsp;
		Dim row As Long<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		Set rs = New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp;
		rs.ActiveConnection = &quot;Provider='Microsoft.Jet.OLEDB.4.0';&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		&quot;Data Source=C:\Program Files\Microsoft Office\OFFICE11\SAMPLES\Northwind.mdb;&quot;<br>
		&nbsp;&nbsp;&nbsp;
		rs.Open &quot;[Customers]&quot;, , adOpenDynamic, adLockOptimistic<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		Set xl = New Excel.Application<br>
		&nbsp;&nbsp;&nbsp;
		Set wb = xl.Workbooks.Add<br>
		&nbsp;&nbsp;&nbsp;
		Set ws = wb.Sheets(&quot;Sheet1&quot;)<br>
		<br>
		&nbsp;&nbsp;&nbsp; </span></span> </font>
<font color="#008000">
		<span class="auto-style17">' Make the column headers.</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;
		For col = 0 To rs.Fields.Count - 1<br>
		&nbsp;&nbsp;&nbsp;
		ws.Cells(1, col + 1) = rs.Fields(col).Name<br>
		&nbsp;&nbsp;&nbsp;
		Next col<br>
		&nbsp;&nbsp;&nbsp;
		ws.Columns(&quot;G:I&quot;).Delete<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 1) = &quot;CustomerID&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 2) = &quot;CompanyName&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 3) = &quot;ContactName&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 4) = &quot;ContactTitle&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 5) = &quot;Address&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 6) = &quot;Phone&quot;<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' ws.Cells(1, 7) = &quot;Fax&quot;<br>
		<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		''' Get data from the database and insert it into the spreadsheet.<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' row = 2<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		' Do While Not rs.EOF<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		'&nbsp;&nbsp;&nbsp; For col = 0 To rs.Fields.Count - 1<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.Cells(row, col + 1) = rs.Fields(col).Value<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		'&nbsp;&nbsp;&nbsp; Next col<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		'&nbsp;&nbsp;&nbsp; row = row + 1<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" color="#008000" class="auto-style17">
		'&nbsp;&nbsp;&nbsp; rs.MoveNext<br>
		</font>
<font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<font color="#008000">
		<span class="auto-style17">' Loop</span></font><font face="Courier New" size="2" color="#000066"><span class="auto-style4"><span class="auto-style1"><br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		</span></span> 
		</font>
		<font color="#008000">
		<span class="auto-style17">'Get data from the database and insert it into the spreadsheet.</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;
		i = 2<br>
		&nbsp;&nbsp;&nbsp;
		Do While Not rs.EOF<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 1) = rs.Fields(&quot;CustomerID&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 2) = rs.Fields(&quot;CompanyName&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 3) = rs.Fields(&quot;ContactName&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 4) = rs.Fields(&quot;ContactTitle&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 5) = rs.Fields(&quot;Address&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 6) = rs.Fields(&quot;City&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 7) = rs.Fields(&quot;Phone&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		ws.Cells(i, 8) = rs.Fields(&quot;Fax&quot;)<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp; 
		</span> 
		</font>
<font color="#008000">
		<span class="auto-style17">&nbsp;' ws.Cells(i, 8) = FormatNumber(rs.Fields(&quot;Fax&quot;), vbFalse, vbFalse, 
		vbFalse)</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		rs.MoveNext<br>
		&nbsp;&nbsp;&nbsp; 
		&nbsp;&nbsp;&nbsp;
		i = i + 1<br>
		&nbsp;&nbsp;&nbsp;
		Loop<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		rs.Close<br>
		&nbsp;&nbsp;&nbsp;
		Set rs = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		Set ws = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		wb.Close True, &quot;C:\myAccessExport.xls&quot;&nbsp;&nbsp;
		</span>
		</font>
		<font color="#008000"><span class="auto-style17">'it saves into this 
		worksheet in C:\</span></font><font face="Courier New" size="2" color="#000066"><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp;
		Set wb = Nothing<br>
		&nbsp;&nbsp;&nbsp; Set xl = Nothing<br>
		End Sub</span></span></p>
<font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table91" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right">
<font face="">
				<a name=CopyAccessDataToExcel></a>
				</font>
		</font></font>
<font face="Arial" size="2" color="#000066">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
<font face="Courier New" size="2" color="#000066">
		<hr>
		</font>
		</font>
		<p class="section_title">
		<span class="auto-style4"><span class="auto-style1">Sub CopyAccessDataToExcel()<br>
		</span>
		<font color="#339933"><span class="auto-style1">'Purpose: </span> </font>
		</span>
		</font>
		<span class="auto-style17">
		<font color="#339933">Copy all data from table 
		'</font></span><font face=""><span class="auto-style17"><font color="#339933">Customers'
		</font></span></font><span class="auto-style17">
		<font color="#339933">into a new
		</font></span>
<font face="">
		<span class="CodeComment">
		<font color="#339933"><span class="auto-style17">sheet name
		</span>
		</font><font color="#008000"><span class="auto-style17">'</span></font></span><font size="2" color="#008000" class="auto-style17">CustomersDetail' 
		_<br>
		of </font></font><span class="auto-style17">
		<font color="#339933">an existing Excel 
		workbook.
		</font></span><font face="Courier New" size="2" color="#000066">
		<span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp; Dim cn As New ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; Dim strConn As String<br>
&nbsp;&nbsp;&nbsp; Dim copied As Long<br>
&nbsp;&nbsp;&nbsp; Screen.MousePointer = vbHourglass<br>
&nbsp;&nbsp;&nbsp; DoEvents<br>
		<br>
&nbsp;&nbsp;&nbsp; strConn = ConnectionString<br>
&nbsp;&nbsp;&nbsp; cn.ConnectionString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Data Source=C:\Program Files\Microsoft 
		Office\OFFICE11\SAMPLES\Northwind.mdb;&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Open strConn<br>
&nbsp;&nbsp;&nbsp; cn.Execute &quot;<b>SELECT</b> * <b>INTO</b> [Excel 8.0;&quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Database=C:\CustomersData.xls].[CustomersDetail] 
		<b>FROM</b> Customers&quot;, copied<br>
&nbsp;&nbsp;&nbsp; cn.Close<br>
		<br>
&nbsp;&nbsp;&nbsp; Screen.MousePointer = vbDefault<br>
&nbsp;&nbsp;&nbsp; MsgBox &quot;Copied &quot; &amp; copied &amp; &quot; records.&quot;<br>
		End Sub</span></span></p>
<font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table92" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right">
<font face="">
				<a name=ADOFSO></a>
				</font>
		</font></font>
<font face="Arial" size="2" color="#000066">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
<font face="Courier New" size="2" color="#000066">
		<hr>
		</font>
		<p class="section_title">
		<font size="2" color="#339933" face="Arial"><br>
		<span class="auto-style17">' You must add reference to the Microsoft Scripting Runtime library in 
		order to use FSO.</span></font><font size="2" face="Courier New" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub FSOWriteLine()<br>
		&nbsp;&nbsp;&nbsp; </span> </font>
		</font>
		<span class="auto-style17">
		<font color="#339933">'Purpose: using ADO and 
		FileSystemObject to export Access data to a text file.</font></span><font face=""><font size="2" face="Courier New" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim cn As ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp; Dim 
		rs As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; Dim 
		fso As FileSystemObject<br>
		&nbsp;&nbsp;&nbsp; Dim 
		txt As TextStream<br>
		&nbsp;&nbsp;&nbsp; Dim 
		strConn As String<br>
		&nbsp;&nbsp;&nbsp; Dim 
		strSql As String<br>
		&nbsp;&nbsp;&nbsp; Dim 
		str As String<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set 
		fso = New FileSystemObject<br>
		&nbsp;&nbsp;&nbsp; Set 
		txt = fso.CreateTextFile(&quot;D:\MyData\My_Data.txt&quot;, True)<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set 
		cn = New ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp; 
		strConn = ConnectionString<br>
		&nbsp;&nbsp;&nbsp; 
		cn.ConnectionString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;Data Source=D:\MyData\Northwind.mdb;&quot;<br>
		&nbsp;&nbsp;&nbsp; 
		cn.Open strConn<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		strSql = &quot;<b>SELECT</b> [EmployeeID], [HireDate], [HomePhone], [Extension] 
		<b>FROM</b> 
		Employees&quot;<br>
		&nbsp;&nbsp;&nbsp; Set 
		rs = New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
		<font size="2" color="#339933" class="auto-style17">' rs.Open &quot;Select EmployeeID, HireDate, HomePhone, Extension From Employees&quot;, , _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adOpenForwardOnly, adLockReadOnly</font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; rs.Open strSql, cn<br>
		&nbsp;&nbsp;&nbsp; txt.WriteLine &quot;EmployeeID, HireDate, HomePhone, 
		Extension&quot;<br>
		&nbsp;&nbsp;&nbsp; Do While Not rs.EOF<br>
		&nbsp;&nbsp;&nbsp; str = &quot;&quot; &amp; FormatNumber(rs(&quot;EmployeeID&quot;), vbFalse, 
		vbFalse, vbFalse) &amp; &quot;, &quot;<br>
		&nbsp;&nbsp;&nbsp; str = str &amp; FormatDateTime(rs(&quot;HireDate&quot;), 
		vbShortDate) &amp; &quot;, &quot;<br>
		&nbsp;&nbsp;&nbsp; str = str &amp; rs(&quot;HomePhone&quot;) &amp; &quot;, &quot;<br>
		&nbsp;&nbsp;&nbsp; str = str &amp; rs(&quot;Extension&quot;)<br>
		&nbsp;&nbsp;&nbsp; txt.WriteLine str<br>
		<br>
		&nbsp;&nbsp;&nbsp; rs.MoveNext<br>
		&nbsp;&nbsp;&nbsp; Loop<br>
		&nbsp;&nbsp;&nbsp; txt.Close<br>
		&nbsp;&nbsp;&nbsp; rs.Close<br>
		&nbsp;&nbsp;&nbsp; Set rs = Nothing<br>
		&nbsp;&nbsp;&nbsp; cn.Close<br>
		&nbsp;&nbsp;&nbsp; Set cn = Nothing<br>
		End Sub</span></font></p>
		<font face="" size="2" color="#000066">
		<table border="0" cellspacing="0" cellpadding="0" id="table94" width="766" height="19">
			<tr>
				<td width="766" height="19" valign="top">
				<p align="right"><font color="#000066">
		<span style="font-size:10.0pt;font-family:&quot;Courier New&quot;"><font face=""><a name=CreateView></a></font>
				</span></font></font>
				</font>
				<font face="Arial" size="2"><b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title"><font color="#000066">
		<span class="auto-style17">F</span></font><font face="Courier New" size="2" class="auto-style1"><font color="#000066"><span class="auto-style4">unction 
		CreateView()</span></font><span class="auto-style4"><br>
&nbsp;&nbsp;&nbsp; </span> </font>
		<span class="CodeComment">
		<font color="#339933" size="2" class="auto-style17">'Purpose: Create a new 
		query and make-table query using SQL string and ADO Execute method. <br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; </span>
		<span class="CodeComment">
		<font color="#339933" size="2" class="auto-style17">'Run the query and 
		then export the table to a closed workbook.<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		<font color="#339933">'This example assumes 
		you have the sample Northwind.mdb file currently open.</font></span><br class="auto-style17">
		<span class="CodeComment">
		<font color="#339933" size="2" class="auto-style17">&nbsp;&nbsp;&nbsp; 'In SQL, a View is a virtual table based on the result-set of an SQL 
		statement.&nbsp;The fields in <br>
&nbsp;&nbsp;&nbsp; 'a View are fields from one or more real tables in the 
		database. You can add SQL functions, <br>
&nbsp;&nbsp;&nbsp; 'WHERE, and JOIN statements to a View and present the data as 
		if the data were coming from one <br>
&nbsp;&nbsp;&nbsp; 'single table. A View always shows up-to-date 
		data.</font></span></p>
		<font face="Courier New">
		<p><font size="2" color="#000066" face="Courier New">&nbsp;&nbsp;&nbsp; </font>
		</font><span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">Dim cn As ADODB.Connection<br>
		</font></span>
		<font face="Courier New">
		<font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">Dim strSql As String, strQuery As String<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">Set cn = CurrentProject.Connection<br>
		<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">strSql = &quot;<b>CREATE VIEW</b> 
		qry_CustomersView <b>AS SELECT</b> Customers.* <b>FROM</b> Customers &quot; &amp; 
		_<br>
		</font></span><font size="2" color="#000066" class="auto-style1">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&quot;<span class="auto-style19">WHERE</span><span class="auto-style4"> City='London'&quot;<br>
		&nbsp;&nbsp;&nbsp; </span> </font>
		<span class="auto-style4">
		<font color="#000066"><span class="auto-style1">cn.Execute strSql&nbsp; 
		</span> </font>
		<font color="#008000"><span class="auto-style1">'create a query named qry_CustomersView</span></font><font size="2" color="#000066" class="auto-style1"><br>
		<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">strSql = &quot;<b>SELECT DISTINCT</b> CustomerID
		<b>AS</b> CustomerCode <b>INTO</b> tblMyCustomer <b>FROM</b> Customers&quot;<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font color="#008000"><span class="auto-style1">'change the field name and create a view 
		(make-table query) named tblMyCustomer</span></font><font color="#000066"><br class="auto-style1">
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">cn.Execute strSql<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">strQuery = &quot;qry_CustomersView&quot;<br>
		<br>
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font color="#008000"><span class="auto-style1">'run the query called qry_CustomersView</span></font><font color="#000066"><br class="auto-style1">
		</font></span><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<span class="auto-style4">
		<font size="2" color="#000066" class="auto-style1">cn.Execute strQuery, , adCmdStoredProc<br>
		<br>
		</font>
		</span>
		<font size="2" color="#000066" class="auto-style4">
		<span class="auto-style1">&nbsp;&nbsp;&nbsp; 
		</span> 
		<font color="#008000"><span class="auto-style1">'export data from tblMyCustomer Table to a 
		worksheet's range</span></font></font></font></font></font><font face="Courier New"><font face="Courier New" size="2" color="#008000"><span class="auto-style17"> 
		(note: if we don't specify <br>
&nbsp;&nbsp;&nbsp; ' sheet name, it will send to the default Properties Sheet1).
		<a target="_blank" href="ADO/PropertiesSheet1.gif">see sample</a></span>.<font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; DoCmd.TransferSpreadsheet acExport, 8, &quot;tblMyCustomer&quot;, &quot;D:\MyData\TestData.xls&quot;, True<br><br>
		&nbsp;&nbsp;&nbsp; MsgBox &quot;A query called 'qry_CustomersView' 
		was created.&quot; &amp; vbCrLf &amp; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp; &quot;A new table called 'tblMyCustomer' was populated, 
		data exported to D:\MyData\TestData.xls&quot;<br><br>
		&nbsp;&nbsp;&nbsp; cn.Close<br>
		&nbsp;&nbsp;&nbsp;
		Set cn = Nothing<br>
		End Function</span></font></p>

		<font face="" size="2" color="#000066">
		<table border="0" cellspacing="0" cellpadding="0" id="table95" width="762" height="19">
			<tr>
				<td width="762" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=CreateModifyTable></a>
				</font></font>
				<b>
				<a style="color: #0166FE" href="#TOP">
				<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		<hr>
		<p>
		<font color="#008000">
		<span class="auto-style17">' The ALTER TABLE statement is used to add, delete, or modify 
		columns in an existing table.</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Function CreateModifyTable()<br>
		</span>
		</font> <font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
<font size="2" color="#008000" class="auto-style1">
		<span class="auto-style4">' Purpose: Modify a table and columns using ADO and SQL string.</span><br class="auto-style4">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; Dim cn As ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; Dim strSql As String<br>
&nbsp;&nbsp;&nbsp; Set cn = CurrentProject.Connection<br>
		<br>
&nbsp;&nbsp;&nbsp;
		</font><font color="#008000"><span class="auto-style17">' Create a table 
		tblTEMP with 2 columns holding 15 and 5 characters length string</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>CREATE TABLE</b> tblTEMP(Employee_Name 
		varchar(15), Employee_ID varchar(5) not null)&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; </span> </font><font color="#008000">
		<span class="auto-style17">' Create 2 
		columns with date datatype</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>ALTER TABLE</b> tblTEMP <b>ADD</b> Date_Joined 
		date, Date_Registered date&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; </span> </font><font color="#008000">
		<span class="auto-style17">' 
		Delete off the last column</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>ALTER TABLE</b> tblTEMP <b>DROP</b> 
		Date_Registered&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; </span> </font><font color="#008000">
		<span class="auto-style17">' Populate 
		values to the three columns</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; </span> </font>
		<font size="2" class="auto-style17">'''strSql = &quot;INSERT 
		INTO tblTEMP (Employee_Name, Employee_ID, Date_Joined) SELECT &quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;'Bob', '12345', '12-Jan-2005' UNION ALL SELECT 
		'Robert', '11234', '25-Jan-2006'&quot;&quot;</font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>INSERT INTO</b> tblTEMP (Employee_Name, 
		Employee_ID, Date_Joined) <b>VALUES</b> &quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;('Bob', 12345, '12-Jan-2005');&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; strSql = &quot;<b>INSERT INTO</b> tblTEMP (Employee_Name, 
		Employee_ID, Date_Joined) <b>VALUES</b> &quot; &amp; _<br>
&nbsp;&nbsp;&nbsp; &quot;('Albert', '11234', '25-Jan-2006');&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; </span> </font><font color="#008000">
		<span class="auto-style17">' Update 
		all occurences of Employee_Name field from 'Bob' to 'Robert'</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>UPDATE</b> tblTEMP <b>SET</b> Employee_Name ='&quot; 
		&amp; &quot;Robert &quot; &amp; &quot;'&quot; &amp; &quot;<b>WHERE</b> &quot; &amp; _<br>
&nbsp;&nbsp;&nbsp; &quot;Employee_Name ='Bob'&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
&nbsp;&nbsp;&nbsp; </span> </font><font size="2" class="auto-style17">'''strSql = &quot;<b>UPDATE</b> 
		tblTEMP <b>SET</b> Employee_Name =&quot;&quot;Robert&quot;&quot; <b>WHERE</b> Employee_Name 
		=&quot;&quot;Bob&quot;&quot;&quot;</font><font size="2" color="#000066" face="Courier New"><span class="auto-style4"><span class="auto-style1"><br>
		<br>
&nbsp;&nbsp;&nbsp; </span></span> </font><font color="#008000">
		<span class="auto-style17">' Delete 
		the entire record where Employee_ID is '11234'</span></font><font size="2" color="#000066" face="Courier New" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; strSql = &quot;<b>DELETE</b> <b>FROM</b> tblTEMP <b>WHERE</b> 
		Employee_ID = &quot;&quot;11234&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Execute strSql<br>
		<br>
&nbsp;&nbsp;&nbsp; cn.Close<br>
&nbsp;&nbsp;&nbsp; set cn = Nothing<br>
		End Function</span></font></p>
		</font>
		<table border="0" cellspacing="0" cellpadding="0" id="table88" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right"><font face=""><a name=CreateCommandObject></a>
		</font>
		</font>
				<font face="Arial" size="2">
				<b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		&nbsp;</p> 
		</font>
		<font size="2" color="#000066" class="auto-style17">
		<p class="section_title">
		Sub CreateCommandObject()<br>
&nbsp;&nbsp;&nbsp; 
		</font><font color="#008000"><span class="auto-style17">'Declare a 
		recordset and a command object</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim rst As ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; Dim cmd As ADODB.Command<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Instantiate 
		the command object</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Set cmd = New ADODB.Command<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Designate 
		where the data comes from</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; cmd.<b>CommandText</b> = &quot;<b>SELECT</b> * <b>FROM</b> 
		tblClients&quot;<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Establish the 
		connection information</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; cmd.ActiveConnection = CurrentProject.Connection<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Use the 
		execute method to return a result set into the recordset object</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Set rst = cmd.Execute<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Print the 
		RecordCount property</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Debug.Print rst.RecordCount 'Prints Recordcount<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Display the 
		resulting data</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Debug.Print rst.GetString<br>
		<br>
&nbsp;&nbsp;&nbsp; 
		</span> 
		</font><font color="#008000"><span class="auto-style17">'Close the 
		recordset and destroy the objects</span></font><font face="Courier New" size="2" color="#000066"><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp; rst.Close<br>
&nbsp;&nbsp;&nbsp; Set rst = Nothing<br>
&nbsp;&nbsp;&nbsp; Set cmd = Nothing<br>
		End Sub</span></span></p><font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table97" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right"><font face="">
				<a name=CommandTextUpdateProcedure></a>
		</font>
		</font>
				<font face="Arial" size="2">
				<b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#000066" face="Courier New" size="2"><br>
		</font></font>
		</font>
		<font face="">
		<font color="#008000"><span class="auto-style17">' Using a Command 
		object, you can avoid using Recordset object and update directly.</span></font></p></font>
		<font face="Courier New" size="2" color="#000066">
		<p class="section_title"><span class="auto-style4">
		<span class="auto-style1">Sub CommandTextUpdateProcedure()<br>
		</span>
		<font color="#008000"><span class="auto-style1">'Purpose: </span> </font>
		</span>
		</font>
		<font color="#008000"><span class="auto-style17">Use CommandText 
		property to update the text of a 
				procedure.</span></font><font color="#000066"><br class="auto-style17">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		On Error GoTo ProcedureTextError<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		Dim cnn As ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp;
		Dim cmd As New ADODB.Command<br>
		&nbsp;&nbsp;&nbsp;
		Dim strConn As String<br>
		<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		</span>
		</font><font color="#008000"><span class="auto-style17">' Open the 
		connection.</span></font><font color="#000066"><br class="auto-style17">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		Set cnn = New ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp;
		strConn = &quot;Provider='Microsoft.Jet.OLEDB.4.0';&quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		&quot;Data Source=C:\Program Files\Microsoft Office\OFFICE11\SAMPLES\Northwind.mdb;&quot;<br>
		&nbsp;&nbsp;&nbsp;
		cnn.Open strConn<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		With cmd<br>
		&nbsp;&nbsp;&nbsp;
		Set cmd.ActiveConnection = cnn<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		</span>
		</font><font color="#008000"><span class="auto-style17">' Update the CommandText.</span></font><font color="#000066"><br class="auto-style17">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		.<b>CommandText</b> = &quot;<b>UPDATE</b> [Products] <b>SET</b> [UnitPrice]=[UnitPrice]+([UnitPrice]*0.025) &quot; &amp; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		&quot;<b>WHERE</b> [ProductName] ='Chai'&quot;<br>
		&nbsp;&nbsp;&nbsp;
		.Execute<br>
		&nbsp;&nbsp;&nbsp;
		End With<br>
		<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		</span>
		</font><font color="#008000"><span class="auto-style17">'Clean up 
		objects.</span></font><font color="#000066"><br class="auto-style17">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		cnn.Close<br>
		&nbsp;&nbsp;&nbsp;
		Set cmd = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		Set cnn = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		Exit Sub<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		ProcedureTextError:<br>
		&nbsp;&nbsp;&nbsp;
		Set cmd = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		If Not cnn Is Nothing Then<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		If cnn.State = adStateOpen Then<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		</span> </font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; cnn.Close<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		End If<br>
		&nbsp;&nbsp;&nbsp;
		End If<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		Set cnn = Nothing<br>
		&nbsp;&nbsp;&nbsp;
		If Err &lt;&gt; 0 Then<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp;
		MsgBox Err.Source &amp; &quot;--&gt;&quot; &amp; Err.Description, , &quot;Error&quot;<br>
		</font><font face="Courier New" size="2" color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp;
		End If<br>
		End Sub</span></p><font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table93" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right"><font face=""><a name=ShowSchema></a>
		</font>
		</font>
				<font face="Arial" size="2">
				<b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#339933" size="2" class="auto-style17">' Besides 
		adding reference to the Microsoft ActiveX Data Objects 2.x Library in VBE, you must also reference to Microsoft Excel <br>
		' Object&nbsp; Library. 
		Your Access database must also be open. This simple function using ADO OpenSchema method will copy all the<br>
		' Access 
		table names to column A in 
		Sheet1 of a new workbook.</font></p>
		<p class="section_title">
		<font color="#000066">
		<span class="auto-style17">Function OpenSchemaExample()</span></font><font size="2" class="auto-style1" color="#000066"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; </span>
		</font>
		<span class="auto-style17">
		<font color="#339933">'Purpose: List the 
		tables names using ADO</font></span><font color="#339933"><span class="auto-style17">, 
		copy them to Excel sheet</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim cn As 
		ADODB.Connection<br>
		&nbsp;&nbsp;&nbsp; Dim rs As 
		ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp; Dim fld As 
		ADODB.Field<br>
		&nbsp;&nbsp;&nbsp; Dim i As 
		Integer<br>
		</span>
		</font><font face="Courier New" size="2" class="auto-style1"><font color="#000066">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim xlapp As 
		Excel.Application, xlwb As Excel.Workbook, xlws As Excel.Worksheet</span></font><span class="auto-style4"><br>
		&nbsp;&nbsp; 
		</span> 
		</font><span class="auto-style17">
		<font color="#339933">'Dim xlrng As 
		Excel.Range</font></span><font size="2" class="auto-style17"><br>
		<br>
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; Set cn = 
		CurrentProject.Connection<br>
		&nbsp;&nbsp;&nbsp; Set rs = 
		cn.OpenSchema(adSchemaTables, Array(Empty, Empty, Empty, &quot;TABLE&quot;))<br>
		<br>
		&nbsp;&nbsp;&nbsp; Set xlapp = 
		New Excel.Application<br>
		&nbsp;&nbsp;&nbsp; 
		xlapp.Visible = True<br>
		&nbsp;&nbsp;&nbsp; Set xlwb = 
		xlapp.Workbooks.Add<br>
		&nbsp;&nbsp;&nbsp; Set xlws = 
		xlwb.ActiveSheet<br>
		</font><font face="Courier New" size="2" class="auto-style1"><font color="#000066">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; i = 1</span></font><span class="auto-style4"><br>
		&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		</span> 
		</font><span class="CodeComment">
		<font color="#339933" size="2" class="auto-style17">' For Each fld In 
		rs.Fields<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span>
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span>
		<span class="CodeComment">
		<font color="#339933" size="2" class="auto-style17">' xlws.Cells(1, 
		i).Value = fld.Name<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' i = i + 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Next fld<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Set xlrng = xlws.Range(&quot;A2&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' xlrng.CopyFromRecordset rs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' xlws.Columns.AutoFit</font></span><br class="auto-style17">
		<font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; Do While Not 
		rs.EOF<br>
		&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		xlws.Cells(i, 1).Value = rs.Fields(&quot;TABLE_NAME&quot;).Value<br>
		&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		i = i + 1<br>
		&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		rs.MoveNext<br>
		&nbsp;&nbsp;&nbsp; Loop<br>
		<br>
		&nbsp;&nbsp;&nbsp; rs.Close<br>
		&nbsp;&nbsp;&nbsp; set rs = 
		Nothing<br>
		&nbsp;&nbsp;&nbsp; cn.Close<br>
		&nbsp;&nbsp;&nbsp; set cn = 
		Nothing<br>
		</font>
		<font color="#000066" face="Courier New"><span class="auto-style17">End Function</span></font></p>
		<font face="" color="#000066" size="2">
		<table border="0" cellspacing="0" cellpadding="0" id="table96" width="762" height="19">
			<tr>
				<td width="762" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=DeleteRecord_ExecuteMethod></a>
		</font>
		</font>
				<font face="Arial" size="2">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
		<hr>
		</font>
		</font>
		<p class="section_title">
		<span class="auto-style17">Sub DeleteRecord_ExecuteMethod()<br>
		</span>
		</font><font size="2" color="#008000" class="auto-style4">
		<span class="auto-style1">'
		Purpose: To delete records using 
				Execute Method (ADO Connection).</span></font></p>
		<p class="section_title">
		<font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; Dim 
		pathConn As String<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		</span>
		</font><font color="#008000"><span class="auto-style17">' Establish the 
		connection to database.</span></font><font color="#000066"><br class="auto-style17">
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		pathConn = &quot;C:\Planning\SafetyStockChangeRecord.mdb&quot;<br>
		<br>
		&nbsp;&nbsp;&nbsp; 
		With New ADODB.Connection<br>
&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp; 
		.Provider = &quot;Microsoft.Jet.OLEDB.4.0&quot;<br>
&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp; 
		.Open pathConn<br>
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		</span>
		</font></font><span class="auto-style4"><font color="#000066">
		<span class="auto-style1">&nbsp;</span></font><font color="#008000"><span class="auto-style1">'&nbsp; 
		criteria for records deletion is: any part number that ends with ' W ' 
		and with date_changed prior to 1/1/2002</span></font></span><font face="Courier New"><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;
		</span>
		</font><font size="2" color="#000066" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		.Execute &quot;<b>DELETE FROM</b> tbl_SafetyStockRecord <b>WHERE</b> &quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp; 
		&quot;((Date_Changed &lt; #1/1/2002#) <b>AND</b> (Part_Number like '%W'))&quot;&nbsp;
		<br>
		</font><font face="Courier New" size="2" color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		End With<br>
		End Sub</span></p>
		<font face="">
		<table border="0" cellspacing="0" cellpadding="0" id="table85" width="762" height="19">
			<tr>
				<td width="762" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=RecordsetOpen></a>
		</font>
		</font>
				<font face="Arial" size="2">
				<a style="color: #0166FE; font-weight:700" href="#TOP">Go To Top</a></td>
			</tr>
		</table>
		<hr>
		<p class="section_title"><font face="Courier New" size="2">
		<font color="#000066"><span class="auto-style17">Function RecordsetOpen()</span></font><span class="auto-style4"><font color="#0033CC"><br class="auto-style1">
		</font></span><font color="#0033CC"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> </font>
		</font>
		<span class="auto-style17">
		<font color="#339933">'Purpose: Open a recordset using ADO, 
		copy to Excel sheet.</font></span></font><font color="#0033CC"><br class="auto-style17">
		</font>
		<font face="">
		<font color="#000066"><font face="Courier New">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; </span> </font>
		<span class="auto-style4">
		<font size="2" class="auto-style1">Dim cn As New ADODB.Connection<br>
		</font></span><font face="Courier New"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">Dim rs As New ADODB.Recordset<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; </span>
		<span class="auto-style4">
		<font size="2" class="auto-style1">Dim strSql As String<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; </span>
		<span class="auto-style4">
		<font size="2" class="auto-style1">Dim i As Integer<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; Dim xlapp As Excel.Application, xlwb As Excel.Workbook, 
		xlws As Excel.Worksheet</span></font></font><font face="Courier New"></p>
		<p><font color="#000066"><font size="2" class="auto-style1">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; cn.Open 
		&quot;Provider=Microsoft.Jet.OLEDB.4.0; data source=D:\MyData\Northwind.mdb;&quot;</span><br class="auto-style4">
		</font><font face="Courier New"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">strSql = &quot;<b>SELECT</b> CompanyName <b>FROM</b> Customers&quot;<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; rs.Open strSql, cn</span></font></font><font face="Courier New"></p>
		<p><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">Set xlapp = New Excel.Application<br>
		</font></span><font face="Courier New"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">xlapp.Visible = True<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; </span>
		<span class="auto-style4">
		<font size="2" class="auto-style1">Set xlwb = xlapp.Workbooks.Add<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; Set xlws = xlwb.ActiveSheet</span></font></font><font face="Courier New"></p>
		<p><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">i = 1<br>
		</font></span><font face="Courier New"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4"><span class="auto-style1">Do While Not rs.EOF&nbsp;&nbsp;&nbsp;&nbsp; 
		</span>
		<font color="#339933"><span class="auto-style1">'rs.EOF and rs.BOF returns True when rs is empty.</span></font><br class="auto-style1">
		</span><span class="auto-style17">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">xlws.Cells(i, 1).Value = rs!CompanyName<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">i = i + 1<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">rs.MoveNext<br>
		</font></span><span class="auto-style17">&nbsp;&nbsp;&nbsp; Loop</span></font></font><font face="Courier New"></p>
		<p><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">rs.Close<br>
		</font></span><font face="Courier New"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span><span class="auto-style4">
		<font size="2" class="auto-style1">set rs = Nothing<br>
		</font></span>
		</font>
		</font><font face="Courier New"><font color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp; cn.Close</span><font size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; </span>
		</font><span class="auto-style4">
		<font size="2" class="auto-style1">set cn = Nothing<br>
		End Function</font></span></font></p>
		</font>
		</font>
		</font>
		</font>
		</font>
		<table border="0" cellspacing="0" cellpadding="0" id="table71" width="765" height="19">
			<tr>
				<td width="765" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=RecordsetFind></a>
		</font>
		</font>
				<b>
				<a style="color: #0166FE" href="#TOP">
				<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title"><font color="#000066">
		<span class="auto-style17">Sub </span> </font>
		<font face="Courier New" size="2" class="auto-style1">
		<font color="#000066"><span class="auto-style4">RecordsetFind(str As String)</span></font><span class="auto-style4"><br>
		&nbsp;&nbsp;&nbsp;
		</span>
		</font>
		<font color="#339933" size="2" class="auto-style17"><span class="CodeComment"> 
		'Purpose: Find a record based on a search string using ADO Find method.<br>
		</span></font><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		<font color="#339933">'This example assumes 
		you have the sample Northwind.mdb file currently open.</font></span><br class="auto-style17">
		<font size="2" color="#000066" class="auto-style17">
&nbsp;&nbsp;&nbsp; Dim rs As ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; Dim strSearch As String<br>
&nbsp;&nbsp;&nbsp; strSearch = &quot;City = '&quot; &amp; str &amp; &quot;'&quot;<br>
&nbsp;&nbsp;&nbsp; Set rs = New ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; With rs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Open &quot;Customers&quot;, 
		CurrentProject.Connection, adOpenStatic, adLockPessimistic<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .MoveFirst&nbsp;&nbsp;&nbsp;
		</font></font>
		</font>
		<font face=""><font color="#339933">
		<span class="auto-style17">'position pointer to beginning of file</span></font><font face="Courier New" size="2" color="#000066"><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Find strSearch<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Do Until .EOF&nbsp;&nbsp; 
		</span></span> <font color="#339933"><span class="auto-style17">'rs.EOF and 
		rs.BOF returns True when rs is empty.</span></font><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		Debug.Print rs(&quot;Company Name&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		.Find strSearch, 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Loop<br>
&nbsp;&nbsp;&nbsp; End With<br>
&nbsp;&nbsp;&nbsp; rs.Close<br>
		&nbsp;&nbsp;&nbsp; set rs = Nothing<br>
		End Sub</span></span></p>
		<p class="section_title">
		<font color="#339933">
		<span class="auto-style17">
		'Or </span></font>
		<span class="auto-style17">
		<font color="#339933">i</font></span><font color="#339933"><span class="auto-style17">n 
		the Immediate Window, for example, type debug.print(&quot;Glendale&quot;)</span></font><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">Sub runFindClients()<br>
		Dim str As String<br>
		str = &quot;Glendale&quot;<br>
		Call FindClients(str)<br>
		End Sub</span></span></p>
		<table border="0" cellspacing="0" cellpadding="0" id="table79" width="764" height="19">
			<tr>
				<td width="764" height="19" valign="top">
				<p align="right">
		<font face="Courier New" size="2" color="#000066">
				<a name=RecordsetSeek></a></font></font>
<font face="Arial" size="2">
		<b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title"><span class="auto-style17">Sub RecordsetSeek(CustomerID As Integer)</span><font face=""><font color="#000066"><br class="auto-style17">
		</font><font color="#339933" size="2" class="auto-style17"><span class="CodeComment"> 
		&nbsp;&nbsp;&nbsp;
		'Find company name record using ADO  ADO Seek(customerID) method.<br>
		&nbsp;&nbsp;&nbsp;
		'This example assumes you have the sample Northwind.mdb file currently 
		open.</span></font><font face="Courier New" size="2" color="#000066"><br class="auto-style17">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp;
		Dim rs As New ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp;
		With rs<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		.Open &quot;Customers&quot;, CurrentProject.Connection, adOpenDynamic, 
		adLockOptimistic,</span><font size="2" class="auto-style17">
		_<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</font><span class="auto-style17">adCmdTableDirect<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		.Index = &quot;PrimaryKey&quot;<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		.Seek CustomerID, adSeekAfterEQ<br>
		&nbsp;&nbsp;&nbsp;
		End With<br>
		<br>
		&nbsp;&nbsp;&nbsp;
		If rs.EOF Then<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		MsgBox &quot;There are no records for Customer &amp; CustomerID, vbOKOnly&quot;<br>
		&nbsp;&nbsp;&nbsp;
		Else<br>
		&nbsp;&nbsp;&nbsp;
		&nbsp;&nbsp;&nbsp;
		MsgBox &quot;Customer &quot; &amp; CustomerID &amp; &quot; is &quot; &amp; rs(&quot;Company Name&quot;), 
		vbOKOnly<br>
		&nbsp;&nbsp;&nbsp;
		End If</span></font></p>
		<p class="section_title">
		<font face="Courier New" size="2" color="#000066">
		<span class="auto-style17">&nbsp;&nbsp;&nbsp;
		rs.Close<br>
		&nbsp;&nbsp;&nbsp;
		set rs = Nothing</span></font><font color="#000066" class="auto-style1" face="Courier New" size="2"><br class="auto-style4">
		<span class="auto-style4">End Sub</span></font></p>
		<table border="0" cellspacing="0" cellpadding="0" id="table81" width="759" height="19">
			<tr>
				<td width="759" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=AddRecord></a>
				</font></font>
				<font face="Arial" size="2"><b>
				<a style="color: #0166FE" href="#TOP">Go To Top</a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#000066" size="2" class="auto-style17">Sub AddRecord(empID As String, fname As String, 
		lname As String, titl As String)<br>
		</font><font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Purpose: Add new records using ADO's AddNew method.</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim cn As 
		ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; Dim rs As ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; Dim strConn As String<br>
		<br>
&nbsp;&nbsp;&nbsp; Set cn = New ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; strConn = ConnectionString<br>
&nbsp;&nbsp;&nbsp; cn.ConnectionString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Data Source=D:\MyData\Northwind.mdb;&quot;<br>
&nbsp;&nbsp;&nbsp; cn.Open strConn<br>
		<br>
&nbsp;&nbsp;&nbsp; Set rs = New ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; With rs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Open &quot;Employees&quot;, cn, adOpenDynamic, 
		adLockOptimistic, adCmdTable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<b>AddNew</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Fields(&quot;EmployeeID&quot;) = empID<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Fields(&quot;LastName&quot;) = fname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Fields(&quot;FirstName&quot;) = lname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Fields(&quot;Title&quot;) = titl<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Update<br>
&nbsp;&nbsp;&nbsp; End With<br>
&nbsp;&nbsp;&nbsp; rs.Close<br>
&nbsp;&nbsp;&nbsp; set rs = Nothing<br>
&nbsp;&nbsp;&nbsp; cn.Close<br>
&nbsp;&nbsp;&nbsp; set cn = Nothing<br>
		End Sub</span></font></p>
		<font face="Courier New" size="2" color="#339933">
		<p class="section_title"><span class="auto-style17">'The routine
		AddData() can be called by the 
		following code.<br>
		'Or you can type AddData &quot;91128&quot;, &quot;William&quot;, &quot;Tan&quot;, &quot;Planning Manager&quot; 
		in the Immediate Window, <br>
		'and then press [Enter]. Open the table 'Employees' in D:\MyData\Northwind.mdb 
		to see the result.</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub runAddRecord()<br>
&nbsp;&nbsp;&nbsp; Dim empID As String, fname As String, lname As String, titl 
		As String<br>
&nbsp;&nbsp;&nbsp; empID = &quot;91128&quot;<br>
&nbsp;&nbsp;&nbsp; fname = &quot;William&quot;<br>
&nbsp;&nbsp;&nbsp; lname = &quot;Tan&quot;<br>
&nbsp;&nbsp;&nbsp; titl = &quot;Planning Manager&quot;<br>
&nbsp;&nbsp;&nbsp; Call AddData(empID, fname, lname, titl)<br>
		End Sub</span></p>
		</font>
		<table border="0" cellspacing="0" cellpadding="0" id="table82" width="761" height="19">
			<tr>
				<td width="761" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=DeleteRecord></a>
				</font>
				</font>
				<b>
				<a style="color: #0166FE" href="#TOP">
				<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#339933"><span class="auto-style17">'Assuming you have added the above record of 
		William into D:\MyData\Northwind.mdb 
		and you are&nbsp; 'currently opening that database. Now you want to 
		delete off William's record.</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub DeleteRecord(empID As Long)<br>
		</span>
		</font><font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp;
		'Purpose: Delete a record using ADO's recordset.Delete method</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;
		Dim rs As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp;
		Dim strSearch As String<br>
		&nbsp;&nbsp;&nbsp;
		Dim strName As String<br>
		&nbsp;&nbsp;&nbsp;
		Dim bytResponse As Byte<br>
		<br>
&nbsp;&nbsp;&nbsp;
		strSearch = &quot;EmployeeID = &quot; &amp; empID<br>
		&nbsp;&nbsp;&nbsp;
		Set rs = New ADODB.Recordset<br>
		<br>
&nbsp;&nbsp;&nbsp;
		With rs<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Open &quot;Employees&quot;, CurrentProject.Connection, adOpenDynamic, 
		adLockOptimistic, adCmdTable<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Find strSearch<br>
		&nbsp;&nbsp;&nbsp;
		If .EOF = True Then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		MsgBox &quot;There is no employee record for employee ID: &quot; &amp; empID, vbOKOnly<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		Exit Sub<br>
		&nbsp;&nbsp;&nbsp;
		Else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		strName = rs.Fields(&quot;LastName&quot;) &amp; &quot; &quot; &amp; rs.Fields(&quot;FirstName&quot;) &amp; &quot; &quot; &amp; 
		rs.Fields(&quot;Title&quot;)<br>
		</span>
		</font><font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		'message to confirm a delete action before execution</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		bytResponse = MsgBox(&quot;Do you want to delete the record for &quot; _<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		&amp; strName &amp; &quot;?&quot;, vbYesNo)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		If bytResponse = vbYes Then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Delete<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		End If<br>
		&nbsp;&nbsp;&nbsp;
		End If<br>
		&nbsp;&nbsp;&nbsp;
		End With<br>
		<br>
&nbsp;&nbsp;&nbsp;
		rs.Close<br>
		&nbsp;&nbsp;&nbsp;
		Set rs = Nothing<br>
		End Sub<br>
		<br>
		</span>
		</font><font face="Courier New" size="2" color="#339933">
		<span class="auto-style17">'The routine
		DeleteRecord() can be called 
		by this simple code.<br>
		'Or type in the Immediate Window DeleteRecord &quot;91128&quot; 
		and press [Enter].</span></font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub runDeleteRecord()<br>
		&nbsp;&nbsp;&nbsp;
		Dim empID As Long<br>
		&nbsp;&nbsp;&nbsp;
		empID = &quot;91128&quot;<br>
		&nbsp;&nbsp;&nbsp;
		DeleteRecord (empID)<br>
		End Sub</span></font></p>
		<table border="0" cellspacing="0" cellpadding="0" id="table75" width="764" height="19">
			<tr>
				<td width="764" height="19" valign="top">
				<p align="right"><font face="Courier New" size="2">
		<a name=ReplaceRecord></a>
		</font>
				</font>
				<b>
				<a style="color: #0166FE" href="#TOP">
				<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#339933" size="2" class="auto-style17">'Assuming you have added the record of 
		William into D:\MyData\Northwind.mdb 
		as in the above <br>
		'example, and you are currently opening that database.</font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub 
		ReplaceRecord(lname As String, LastName As String)<br>
		&nbsp;&nbsp;&nbsp; </span> </font>
		<font color="#339933" size="2" class="auto-style17">
		'Purpose: Explicitly and implicitly call <b>Update</b> to change a 
		record's value, one at a time</font><font color="#000066" face="Courier New" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;
		Dim rs As ADODB.Recordset<br>
		&nbsp;&nbsp;&nbsp;
		Set rs = New ADODB.Recordset<br>
		<br>
&nbsp;&nbsp;&nbsp;
		With rs<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Open &quot;Employees&quot;, CurrentProject.Connection, adOpenDynamic, 
		adLockOptimistic<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Find &quot;LastName = '&quot; &amp; lname &amp; &quot;'&quot;<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		If .EOF = True Then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		MsgBox &quot;There are no matches&quot;, vbOKOnly<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		Exit Sub<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		Else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.Fields(&quot;LastName&quot;) = LastName<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.<b>MoveNext</b>&nbsp; </span> </font>
		<font color="#339933" class="auto-style17">' 
		this implicitly call the <b>Update</b> method after stating the new 
		value=LastName in </font><font color="#339933">
		<span class="auto-style16">.</span></font><font color="#339933" class="auto-style1"><span class="auto-style4">Fields(&quot;LastName&quot;).</span></font><font face="Courier New" color="#000066" size="2" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		.M<b>ovePrevious</b><br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
		<font color="#339933" class="auto-style17">' Or alternatively, use the following syntax 
		which explicitly call the <b>Update</b> method.</font><font color="#339933"><br class="auto-style17">
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<font color="#339933"><span class="auto-style17">'</span></font><font color="#FF0000"><span class="auto-style17">.Fields(&quot;LastName&quot;) = LastName</span></font><font color="#339933"><br class="auto-style17">
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<font color="#339933"><span class="auto-style17">'</span></font><font face="Courier New" size="2" color="#FF0000">.<span class="auto-style16">Update</span></font><font color="#339933"><br class="auto-style17">
		</font><font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		</span> </font>
		<font color="#339933" class="auto-style1"><span class="auto-style4">' Or simply just type: 
		</span> </font>
		<font color="#FF0000"><span class="auto-style17">.Update &quot;LastName&quot;, LastName</span></font><font face="Courier New" color="#000066" size="2"><span class="auto-style1"><br class="auto-style4">
		</span><span class="auto-style4"><span class="auto-style1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		MsgBox &quot;Replacing &quot; &amp; lname &amp; &quot; with &quot; &amp; LastName, vbOKOnly<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		End If<br>
		&nbsp;&nbsp;&nbsp;
		End With<br>
		&nbsp;&nbsp;&nbsp;
		<br>
		&nbsp;&nbsp;&nbsp;
		rs.Close<br>
		&nbsp;&nbsp;&nbsp; 
		set rs = Nothing<br>
		End Sub</span></span><br>
&nbsp;</font></p>
		<table border="0" width="80%" cellspacing="0" cellpadding="3" id="table76" class="auto-style21" style="height: 177px">
			<tr>
				<td colspan="2" class="auto-style30" style="height: 23px">To move about the 
				recordset, use these five methods:</td>
			</tr>
			<tr>
				<td width="19%" bordercolor="#808080" style="height: 28px;" class="auto-style27">
				<a class="type1" href="ADO/ADO_MoveFirst_MoveLast_MoveNext_MovePrevious_Methods.htm">
				<span class="auto-style28"><strong>MoveFirst</strong></span></a></td>
				<td bordercolor="#808080" style="height: 28px;" width="80%" class="auto-style32">
				Move the record pointer to the first 
				record in the recordset.</td>
			</tr>
			<tr>
				<td width="19%" bordercolor="#808080" style="height: 23px;" class="auto-style31">
				<a class="type1" href="ADO/ADO_MoveFirst_MoveLast_MoveNext_MovePrevious_Methods.htm" style="color: #808000">
				<strong>MoveNext</strong></a></td>
				<td bordercolor="#808080" style="height: 23px;" width="80%" class="auto-style32">
				Move the record pointer forward to 
				the next record.</td>
			</tr>
			<tr>
				<td width="19%" bordercolor="#808080" class="auto-style31">
				<a class="type1" href="ADO/ADO_MoveFirst_MoveLast_MoveNext_MovePrevious_Methods.htm" style="color: #808000">
				<strong>MovePrevious</strong></a></td>
				<td bordercolor="#808080" width="80%" class="auto-style32">
				Move the record pointer backward to 
				the previous record.</td>
			</tr>
			<tr>
				<td width="19%" bordercolor="#808080" class="auto-style31">
				<a class="type1" href="ADO/ADO_MoveFirst_MoveLast_MoveNext_MovePrevious_Methods.htm" style="color: #808000">
				<strong>MoveLast</strong></a></td>
				<td bordercolor="#808080" width="80%" class="auto-style32">
				Move the record pointer to the last 
				record in the recordset.</td>
			</tr>
			<tr>
				<td width="19%" bordercolor="#808080" class="auto-style31">
				<font color="#000066">
				<a class="type1" href="ADO/ADO_Move_Method.htm" style="color: #808000">
				<strong>Move</strong></a></font></td>
				<td bordercolor="#808080" width="80%" class="auto-style32">
				<font color="#000066">Move the record pointer a specific 
				number of records from the current record.</font></td>
			</tr>
			</table>
		<p style="height: 8px">&nbsp;</p>
		<table border="0" cellspacing="0" cellpadding="0" id="table83" width="766" height="19">
			<tr>
				<td width="766" height="19" valign="top">
				<p align="right">
		<font face="Courier New" size="2">
		<a name=ReplaceAllRecords></a>
				</font><b>
				<a style="color: #0166FE" href="#TOP">
		<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
        <hr>
		<p class="section_title">
		<font color="#000066" face="Courier New" size="2">S<span class="auto-style17">ub 
		ReplaceAllRecords(ct As String, City As String)<br>
		</span>
		</font><font size="2" color="#339933" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Purpose: implicitly call to Update in transaction to make all changes 
		at one time.<br>
&nbsp;&nbsp;&nbsp; 'Assume you are currently openning the sample Northwind.mdb 
		file.</font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim cn As ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; Dim rs As ADODB.Recordset<br>
&nbsp;&nbsp;&nbsp; Dim bytResponse As Byte<br>
		<br>
&nbsp;&nbsp;&nbsp; Set cn = CurrentProject.Connection<br>
&nbsp;&nbsp;&nbsp; Set rs = New ADODB.Recordset<br>
		<br>
&nbsp;&nbsp;&nbsp; With rs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Open &quot;Customers&quot;, cn, adOpenDynamic, 
		adLockOptimistic, adCmdTable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Find &quot;City = '&quot; &amp; ct &amp; &quot;'&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If .EOF = True Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;There are no 
		matches&quot;, vbOKOnly<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.<b>BeginTrans</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Do Until .EOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If .Fields(&quot;City&quot;) 
		= ct Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		.Fields(&quot;City&quot;) = City<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else&nbsp;
		<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		.MoveNext<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Loop<br>
		<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bytResponse = 
		MsgBox(&quot;Ready to replace City Field's all records of '&quot; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; ct &amp; 
		&quot;' to '&quot; &amp; City &amp; &quot;'?&quot;, vbYesNo)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If bytResponse = vbYes 
		Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.<b>CommitTrans</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElseIf bytResponse = vbNo 
		Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.<b>RollbackTrans</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
&nbsp;&nbsp;&nbsp; End With<br>
		<br>
&nbsp;&nbsp;&nbsp; rs.Close<br>
&nbsp;&nbsp;&nbsp; Set rs = Nothing<br>
		End Sub<br>
		<br>
		<br>
		</span>
		</font><font face="Courier New" size="2" color="#339933">
		<span class="auto-style17">'The routine
		ReplaceAllRecords() can be called 
		by this code.</span></font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">Sub runReplaceAllRecords()<br>
		</span>
		</font><font size="2" color="#339933" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Purpose: replace all records of city names from 'Lisboa' to 'Lisbon', 
		in the <br>
&nbsp;&nbsp;&nbsp; 'table called Customers, all at one time.</font><font face="Courier New" size="2" color="#000066" class="auto-style1"><br class="auto-style4">
		<span class="auto-style4">&nbsp;&nbsp;&nbsp; Dim ct As String, City As String<br>
&nbsp;&nbsp;&nbsp; ct = &quot;Lisboa&quot;<br>
&nbsp;&nbsp;&nbsp; City = &quot;Lisbon&quot;<br>
&nbsp;&nbsp;&nbsp; ReplaceAllRecords(ct, City)<br>
		End Sub</span></font></p>
		<p class="section_title">
		&nbsp;</p>
		<table border="0" width="93%" cellspacing="0" cellpadding="3" id="table86" class="auto-style21">
			<tr>
				<td colspan="2" class="auto-style17">Use these three methods 
				of the Connection objects to implement transaction processing:</td>
			</tr>
			<tr>
				<td colspan="2" class="auto-style17">&nbsp;</td>
			</tr>
			<tr>
				<td width="14%" bordercolor="#808080" class="auto-style32">
				<a class="type1" href="ADO/ADO_BeginTrans_CommitTrans_RollbackTrans.htm">
				<strong>BeginTrans</strong></a></td>
				<td bordercolor="#808080" width="84%" class="auto-style32">
				Starts a new transaction. It can 
				also be used to return a long value that is the level of nested 
				transactions.</td>
			</tr>
			<tr>
				<td width="14%" bordercolor="#808080" class="auto-style36">
				<a class="type1" href="ADO/ADO_BeginTrans_CommitTrans_RollbackTrans.htm">
				<strong>CommitTrans</strong></a></td>
				<td bordercolor="#808080" width="84%" class="auto-style36">
				It saves all changes made since the 
				last BeginTrans method call, and ends the current transaction.</td>
			</tr>
			<tr>
				<td width="14%" bordercolor="#808080" class="auto-style36">
				<a class="type1" href="ADO/ADO_BeginTrans_CommitTrans_RollbackTrans.htm">
				<strong>RollbackTrans 
				</strong> 
				</a></td>
				<td bordercolor="#808080" width="84%" class="auto-style36">
				All the uncommitted changes are 
				dumped.</td>
			</tr>
			</table>
		<p><br>
&nbsp;</p>
		<table border="0" cellspacing="0" cellpadding="0" id="table77" width="770" height="19">
			<tr>
				<td width="770" height="19" valign="top">
				<p align="right">
<font face="">
				<a name=ShowMultipleUsers></a>
				</font><b>
				<a style="color: #0166FE" href="#TOP">
<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		<hr>
		<p class="section_title">
		<font color="#000066" face="Courier New" size="2">
		<br>
		<span class="auto-style17">Global Const 
		JET_SCHEMA_USERROSTER = &quot;{947bb102-5d43-11d1-bdbf-00c04fb92675}&quot;</span></font></p>
		<p class="section_title"><font size="2" class="auto-style17">
		<font color="#000066">Function ShowMultipleUsers()</font><br>
		</font><font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Source: KB 198755</span></font><br class="auto-style17">
		<font color="#000066" size="2" class="auto-style17">&nbsp;&nbsp;&nbsp; Dim 
		cn As New ADODB.Connection<br>
&nbsp;&nbsp;&nbsp; Dim rs As New ADODB.Recordset<br>
		<br>
&nbsp;&nbsp;&nbsp; On Error GoTo HandleErr<br>
&nbsp;&nbsp;&nbsp; 
		</font>
		<font size="2" class="auto-style17"><font color="#000066">cn.Open 
		&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; &quot;Data Source=D:\MyData\Northwind.mdb&quot;</font><br>
		<br>
		</font><font size="2" color="#339933" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'The user roster is exposed as a provider-specific schema rowset in the 
		Jet 4 OLE DB provider.<br>
&nbsp;&nbsp;&nbsp; 'You have to use a GUID to reference the schema, as 
		provider-specific schemas are not listed<br>
&nbsp;&nbsp;&nbsp; 'in ADO's type library for schema rowsets.</font><br class="auto-style17">
		<font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
		<font size="2" class="auto-style17"><font color="#000066">Set rs = 
		cn.OpenSchema(adSchemaProviderSpecific, , JET_SCHEMA_USERROSTER)</font><br>
		<br>
		</font><font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Output the list of all users in the current database</span></font><br class="auto-style17">
		<font color="#000066"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		</span> 
		</font>
		<font face="Courier New" size="2"><font color="#000066">
		<span class="auto-style4"><span class="auto-style1">Debug.Print 
		rs.Fields(0).Name, &quot;&quot;, rs.Fields(1).Name, &quot;&quot;, rs.Fields(2).Name, 
		rs.Fields(3).Name</span></span></font><span class="auto-style4"><span class="auto-style1"><br>
		</span></span>
		<font color="#339933"><span class="auto-style17">&nbsp;&nbsp;&nbsp; 
		'Debug.Print rst.GetString</span></font><font face=""><font size="2" class="auto-style17"><br>
		<br>
		</font>
		<font color="#000066" size="2" class="auto-style17">&nbsp;&nbsp;&nbsp; 
		While Not rs.EOF<br>
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; Debug.Print rs.Fields(0), rs.Fields(1), rs.Fields(2), 
		rs.Fields(3)<br>
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; rs.MoveNext<br>
&nbsp;&nbsp;&nbsp; Wend<br>
		<br>
&nbsp;&nbsp;&nbsp; cnn.Close<br>
&nbsp;&nbsp;&nbsp; set cn = Nothing<br>
&nbsp;&nbsp;&nbsp; rs.Close<br>
&nbsp;&nbsp;&nbsp; set rs = Nothing<br>
&nbsp;&nbsp;&nbsp; Exit Function<br>
		<br>
		HandleErr:<br>
&nbsp;&nbsp;&nbsp; MsgBox &quot;Error &quot; &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Description<br>
&nbsp;&nbsp;&nbsp; 
		Exit Function<br>
		End Function</font></font></font></font></font><font face=""><font face="Courier New" size="2"><p>
		<br class="auto-style17">
		</font>
<font size="2" face="Arial">
		<span class="auto-style38">This particular schema recordset contains the following information:</span><span class="auto-style17">
		</span>
		<ul>
			<li class="auto-style1"><span class="auto-style4">COMPUTER_NAME. Identifies the workstation as specified in 
			the system's Network control panel. </li>
			</span><span class="auto-style17">
			<li>LOGIN_NAME. Specifies the name the user entered to log 
			into the database, if it's secured. If it isn't secured, this field 
			returns Admin. </li>
			<li>CONNECTED. Returns True (-1) if there's a corresponding 
			user lock in the LDB file. (The .ldb file is used to determine which 
			records are locked in a shared database and by whom).</li>
			<li>SUSPECTED_STATE. Returns True (-1) if the user has left 
			the database in a suspect state. Otherwise, this value is Null. 
			</li>
		</ul>
		<p>If you'd like to see the results, type ShowMultipleUsers in the 
		Immediate Window and press [Enter] to run the procedure..</p>
		</span><span class="auto-style1">
		<p class="auto-style4">Table A lists out the global constants and GUIDs 
		that apply to the Jet provider.</span></p>
<font face="Courier New" size="2" color="#000066">
		<p class="auto-style17" style="height: 21px">
		<font color="#000066">
		<strong>Table A: Jet OLE DB provider-specific constants</strong></font></p>
		<font face="" size="2" color="#000066">
		<table border="0" cellspacing="0" cellpadding="0" id="table74" style="width: 85%">
			<tr>
				<td style="border-style: solid; border-width: 1px; width: 318px;" bordercolor="#999999" class="auto-style37">
				<strong>Constant</strong></td>
				<td style="border-style: solid; border-width: 1px" bordercolor="#999999" class="auto-style37">
				<strong>GUID</strong></td>
			</tr>
			<tr>
				<td style="border-style: solid; border-width: 1px; width: 318px;" bordercolor="#999999" class="auto-style17">
				JET_SCHEMA_USERROSTER</td>
				<td style="border-style: solid; border-width: 1px" bordercolor="#999999" class="auto-style17">
				{947bb102-5d43-11d1-bdbf-00c04fb92675}</td>
			</tr>
			<tr>
				<td style="border-style: solid; border-width: 1px; width: 318px;" bordercolor="#999999" class="auto-style17">
				JET_SCHEMA_REPLPARTIALFILERLIST</td>
				<td style="border-style: solid; border-width: 1px" bordercolor="#999999" class="auto-style17">
				{e2082df0-54ac-11d1-bdbb-00c04fb92675}</td>
			</tr>
			<tr>
				<td style="border-style: solid; border-width: 1px; width: 318px;" bordercolor="#999999" class="auto-style17">
				JET_SCHEMA_REPLCONFLICTTAGBLES</td>
				<td style="border-style: solid; border-width: 1px" bordercolor="#999999" class="auto-style17">
				{e2082df2-54ac-11d1-bdbb-00c04fb92675}</td>
			</tr>
			<tr>
				<td style="border-style: solid; border-width: 1px; width: 318px;" bordercolor="#999999" class="auto-style17">
				JET_SCHEMA_ISAMSTATS</td>
				<td style="border-style: solid; border-width: 1px" bordercolor="#999999" class="auto-style17">
				{8703b612-5d43-11d1-bdbf-00c04fb92675}</td>
			</tr>
		</table>
		<span id="dnn_ctr436_HtmlModule_HtmlHolder1" class="Normal">
		<div align="left">
		<table border="0" cellspacing="0" cellpadding="0" id="table69" width="775" height="19">
			<tr>
				<td width="775" height="19" valign="top">
				<p align="right"><b>
				<a style="color: #0166FE" href="#TOP">
				<font size="2" face="Arial">Go To Top</font></a></b></td>
			</tr>
		</table>
		</div>
		</span>
		       
       	</font>
		</font>
		       
       	</font>
		       
       </td>
       </tr>
</table>


<table border="0" width="993" id="table5" cellspacing="0" cellpadding="2" height="68" background="../YellowTexture.gif">
<tr>
<td align="center" width="989">
	
<br>
  <!-- Histats.com  START  -->   
 <script  type="text/javascript" language="javascript">   
 var s_sid = 279773;var st_dominio = 4; 
 var cimg = 408;var cwi =270;var che =55; 
 </script> 
 <script  type="text/javascript" language="javascript" src="http://s10.histats.com/js9.js"></script> 
 <noscript><a href="http://www.histats.com" target="_blank"> 
 <img  src="http://s4.histats.com/stats/0.gif?279773&1" alt="counter stats" border="0"></a> 
 </noscript> 
  <!-- Histats.com  END  --> 
  
 
 <br><br class="auto-style17">	
	<span class="auto-style17">This site  
	was created in February 2007 <br>by William Tan.</span></td>
</tr>
</table>

</body></html>