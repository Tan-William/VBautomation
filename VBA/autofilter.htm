<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<!-- Mirrored from vbautomation.110mb.com/VBA/autofilter.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:52:57 GMT -->
<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Excel Macros/Excel VBA code. Excel VBA Macro Tips for Beginners. Excel Macros Help</title>
<meta name="author" content="William Tan, https://github.com/william-pbTan/VBautomation.git">
<meta name="Description" content="Excel Macros: Excel VBA Macros. Free help on Excel Macros, Free Excel VBA code">
<meta name="Keywords" content="excel macros,Excel VBA,excel,vba,tips,tricks,excel vba,Visual Basic For Applications,help">
<meta name="keywords" content="Poh,William,Excel,Access,VBA,Forecasting,Inventory">
<meta name="keywords" content="Excel macro tips,Excel macro training,Excel tips,Home,Office,Basic,Intermediate,Advance">
<meta name="keywords" content="Singapore, Kuala Lumpur, KL, Malaysia, Hong Kong, Taiwan, Japan, China, Korea, Sarawak">
<meta name="generator" content="Microsoft FrontPage 12.0">
</head>

<script language="javascript">
// Courtesy of SimplytheBest.net - http://simplythebest.net/scripts/
var win = null;
function NewWindow(mypage,myname,w,h,scroll){
LeftPosition = (screen.width) ? (screen.width-w)/2 : 0;
TopPosition = (screen.height) ? (screen.height-h)/2 : 0;
settings =
'height='+h+',width='+w+',top='+TopPosition+',left='+LeftPosition+',scrollbars='+scroll+',resizable'
win = window.open(mypage,myname,settings)
}
</script>


<script type="text/javascript">
<!--if (top.location != location) {top.location.href = document.location.href ;}-->
</script>


<style>
<!--
.new_link {color: #000000;  font-family: Verdana, Arial, Helvetica, sans-serif;   font-size: 11px; text-decoration: none; font-weight: normal;}
-->
</style>

<body background="../logo.gif" style="background-attachment: fixed">

<style type="text/css">
body {scrollbar-3dlight-color:#000000;
scrollbar-arrow-color:#FFFFFF;
scrollbar-base-color:#ffffff;
scrollbar-darkshadow-color:#000000;
scrollbar-face-color:#339933;
scrollbar-highlight-color:#ffffff;
scrollbar-shadow-color:#ffffff}
 li.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	margin-left:0in; margin-right:0in; margin-top:0in}
table.MsoTableGrid
	{border:1.0pt solid windowtext;
	font-size:10.0pt;
	font-family:"Times New Roman";
	}
h1
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Arial;
	}
.auto-style1 {
	color: #000000;
	font-family: Verdana;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
}
.auto-style2 {
	font-family: Verdana;
	font-size: 10.5pt;
}
.auto-style3 {
	color: #0045C3;
	font-family: Verdana;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
}
.auto-style4 {
	font-family: Verdana;
	font-size: 10.5pt;
	text-decoration: none;
	font-weight: normal;
}
.auto-style5 {
	color: #0045C3;
}
.auto-style6 {
	font-family: Verdana;
}
.auto-style7 {
	font-family: Verdana;
	font-weight: bold;
}
.auto-style8 {
	font-family: Arial;
	font-weight: bold;
	font-size: 22pt;
}
.auto-style9 {
	font-family: Arial;
	font-weight: bold;
}
.auto-style10 {
	font-size: 10.5pt;
}
.auto-style11 {
	font-family: Verdana;
	font-weight: bold;
	font-size: 10.5pt;
	border: 1.0pt solid windowtext;
	padding: 0in 5.4pt;
}
.auto-style12 {
	font-family: Verdana;
	font-weight: bold;
	font-size: 10.5pt;
	border-left: 1.0pt solid windowtext;
	border-right: 1.0pt solid windowtext;
	border-top-style: none;
	border-top-color: inherit;
	border-top-width: medium;
	border-bottom: 1.0pt solid windowtext;
	padding: 0in 5.4pt;
}
.auto-style13 {
	font-size: 10.5pt;
	font-family: Verdana;
	border-left-style: none;
	border-left-color: inherit;
	border-left-width: medium;
	border-right: 1.0pt solid windowtext;
	border-top-style: none;
	border-top-color: inherit;
	border-top-width: medium;
	border-bottom: 1.0pt solid windowtext;
	padding: 0in 5.4pt;
}
.auto-style14 {
	font-family: Verdana;
	font-weight: bold;
	font-size: 10.5pt;
}
.auto-style15 {
	font-family: Verdana;
	font-size: 14pt;
}
.auto-style16 {
	font-size: 10.5pt;
	font-family: Verdana;
	color: #339966;
	margin-left: 0in;
	margin-right: 0in;
	margin-top: 0in;
	margin-bottom: .0001pt;
}
.auto-style17 {
	font-size: 10.5pt;
	font-family: Verdana;
	margin-left: 0in;
	margin-right: 0in;
	margin-top: 0in;
	margin-bottom: .0001pt;
}
.auto-style18 {
	font-size: 10.5pt;
	color: #CC3300;
	font-family: Verdana;
	font-weight: bold;
}
.auto-style20 {
	font-size: 10.5pt;
	font-family: Verdana;
	border-left-style: none;
	border-left-color: inherit;
	border-left-width: medium;
	border-right: 1.0pt solid windowtext;
	border-top: 1.0pt solid windowtext;
	border-bottom: 1.0pt solid windowtext;
	padding: 0in 5.4pt;
}
.auto-style22 {
	font-size: 10.5pt;
	color: #CC3300;
	font-family: Verdana;
}
.auto-style23 {
	font-size: 10.5pt;
	color: #339966;
	font-family: Verdana;
}
.auto-style24 {
	font-size: 14pt;
}
</style>

<font face="">
<TABLE border="0" cellspacing="3" width="100%">
<TBODY>
<tr>
<td bgcolor="#ffffff" valign="top" width="13%" align="center">
</font>


<font face="">	
 <TABLE bgcolor="#3399cc" border="0" cellpadding="0" cellspacing="0" width="158">
  <TBODY>
	<TR>
	 <TD>
       <TABLE border="0" cellpadding="3" cellspacing="1" width="161">
         <TBODY>


					<tr width="159">
					<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<a href="../index.htm" rel="internal" class="auto-style1">Home</a></td>
					</tr>
					
					<tr width="159">
					<td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<a href="../AboutMe/Me.htm" rel="internal" class="auto-style1">
					About me</a></td>
					</tr>
                     
		<TBODY>
		<td bgcolor="#3399cc" height="135" width="153">
		<p align="left">
		<img border="0" src="../logo-excelvba_1.gif" width="153" height="59"><br>
		<img border="0" src="../logo-excelvba_2.gif" width="153" height="68"></td>
		</TBODY>                  
                                                
                                                
				<tr height="" width="159">
				<td bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
				<font class="auto-style1"><strong><br>
				&nbsp;<i>VBA Programming</i></strong></font></font></font><span class="auto-style2">
				</span>

<font face="">
                                     
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" align="left" class="auto-style2">
					<a href="Sub_VBA/WilliamExcelUtilities.zip" rel="internal" class="auto-style4">
					<strong><span class="auto-style5">Download</span></strong></a><a href="Sub_VBA/WilliamExcelUtilities.zip" rel="internal" class="auto-style1"> my Add-In 
					tool (<em>run on 32-bit MS Office Excel</em>)</a></td>
                    </tr>  
                                                                  
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" align="left" height="28" class="auto-style2">
					<a href="beginner_basic.htm" rel="internal" class="auto-style1">
					VBA Basic for beginners</a></td>
                    </tr>
                    
                    <tr width="159">
                    <td onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<a href="Objects.htm" rel="internal" class="auto-style1">Excel 
					Main Objects</a></td>
                    </tr>
                    
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<a href="rows_columns.htm" rel="internal" class="auto-style1">
					More with Rows, Columns, Cells, Range ...</a></td>
                    </tr>
                    
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<a href="workaround_worksheet.htm" rel="internal" class="auto-style1">Working 
					around your Worksheet ...</a></td>
                    </tr>
                                        
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<a href="statements.htm" rel="internal" class="auto-style1">
					Statements</a></td>
                    </tr>
                                   
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
 					<a href="functions.htm" rel="internal" class="auto-style1">
					Functions</a><span class="auto-style2"></font></span></td>
                    </tr>
                                   
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<font face="">	
 					<a href="loops.htm" rel="internal" class="auto-style1">
					Conditional Statements and Loops Structure</a></font><span class="auto-style2">
					</span></td>
                    </tr>
                                                                   
					<tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<a href="errors_handling.htm" rel="internal" class="auto-style1">
					Errors Handling</a><span class="auto-style2"></font></span></td>
                    </tr>
                                        
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<a href="userforms.htm" rel="internal" class="auto-style1">UserForms</a><span class="auto-style2"></font></span></td>
                    </tr>
                    
                    <tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<a href="pivot_table.htm" rel="internal" class="auto-style1">
					Pivot Tables</a><span class="auto-style2"></font></span></td>
                    </tr>
					
					<tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<font face="">	
 					<a href="charting.htm" rel="internal" class="auto-style1">Charting</a></font></td>
                    </tr>		
					
					<tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<font face="">	
 					<a href="autofilter.htm" rel="internal" class="auto-style3">
					AutoFilter, Advanced Filter</a></font></td>
                    </tr>

					<tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<font face="">	
 					<a href="File_IO_VisualBasic.htm" rel="internal" class="auto-style1">
					File I/O VBA Examples</a></font></td>
                    </tr>     
                    
					<tr width="159">
                    <td style="cursor: pointer" onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" class="auto-style2">
					<font face="">	
 					<a href="ado_dao.htm" rel="internal" class="auto-style1">ADO and 
					DAO, integrating Excel and Access</a></font></td>
                    </tr>
                    
					<tr width="159">
                    <td onmouseover="this.style.backgroundColor='#339933'; this.style.cursor='hand'; this.style.cursor='pointer';" onmouseout="this.style.backgroundColor='#FFFF66';" bgcolor="#FFFF66" valign="middle" width="153" height="28" class="auto-style2">
					<a href="excel_fun_staff.htm" rel="internal" class="auto-style1">
					Other VBA fun staff</a></td>
                    </tr>


                    <tr HEIGHT="130" width="159">
                    <td bgcolor="#FFFF66" width="153" height="3756">
					<p></p>
					</tr>

					</TBODY></TABLE>
				</TD>
			</TR>
		</TBODY></TABLE>

<font face="">

<font face="">

<font face="">

<font face="">

<font face="">
						
			
<td bgcolor="#FFFFFF" WIDTH="3%"></td>
<td valign="top" width="82%">
      <!-- Start Page Content -->
		<p><span style="font-size: 22.0pt" class="auto-style9">A</span><span class="auto-style8">utoFilters 
		and Advanced Filters</span><span class="auto-style7"><br class="auto-style10">
		</span><font face="">
		<span class="auto-style2"><br>The 
		syntax of the <b>AutoFilter</b> property is:</span></font><b><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">expression.AutoFilter(Field, Criteria1, Operator, Criteria2, 
		VisibleDropDown)</span></font></b><font face=""></p>
		<font face="">
		<table class="MsoTableGrid" border="1" cellspacing="0" cellpadding="0" style="border-style: none; border-color: inherit; border-width: medium; border-collapse: collapse; margin-left: 5.4pt; width: 790px;" id="table6">
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " class="auto-style11">
				expression</td>
				<td valign="top" style="width: 605px; border-left: medium none; border-right: 1.0pt solid windowtext; border-top: 1.0pt solid windowtext; border-bottom: 1.0pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in">
				<span class="auto-style2">Required. It 
				returns one of the objects in the Applies To list.</span><span class="auto-style14">&nbsp;</span></td>
			</tr>
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " height="33" class="auto-style12">
				Field</td>
				<td valign="top" style="width: 605px; " height="33" class="auto-style13">
				Optional 
				Variant. The integer offset of the field on which you want to 
				base the filter (from the left of the list; the leftmost field 
				is field 1)</td>
			</tr>
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " class="auto-style12">
				Criteria1</td>
				<td valign="top" style="width: 605px; " class="auto-style13">
				Optional 
				Variant. The criteria (a string; for example, &quot;021&quot;). You can 
				use &quot;=&quot; or &quot;&lt;&gt;&quot; for your find. If this argument is omitted, the 
				criteria is All.</td>
			</tr>
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " class="auto-style12">
				Operator</td>
				<td valign="top" style="width: 605px; " class="auto-style13">
				Optional. 
				XlAutoFilterOperator can be one of these constants:<br>
				xlAnd (default)<br>
				xlBottom10Items<br>
				xlBottom10Percent<br>
				xlOr<br>
				xlTop10Items <br>
				xlTop10Percent <br>
				Use xlAnd and xlOr with Criteria1 and Criteria2 to construct 
				compound criteria. </td>
			</tr>
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " class="auto-style12">
				Criteria2</td>
				<td valign="top" style="width: 605px; " class="auto-style13">
				Optional 
				Variant. The second criteria (a string). Used with Criteria1 and 
				Operator to construct compound criteria.</td>
			</tr>
			<tr>
				<td width="118" valign="top" style="width: 88.2pt; " class="auto-style12">
				VisibleDropDown</td>
				<td valign="top" style="width: 605px; border-left: medium none; border-right: 1.0pt solid windowtext; border-top: medium none; border-bottom: 1.0pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in">
				<span class="auto-style2">Optional 
				Variant. True to display the AutoFilter drop-down arrow for the 
				filtered field. False to hide the AutoFilter drop-down arrow for 
				the filtered field. True by default.</span><span class="auto-style14">&nbsp;</span></td>
			</tr>
		</table>
		<p class="auto-style2">Note:<b> </b>If 
		you omit all the arguments, this method simply toggles the display of 
		the AutoFilter drop-down arrows in the specified range.</p>
		<p><b><span style="font-size: 14.0pt; font-family: Arial"><br>
		</span></b></font></font><b><span class="auto-style15">AutoFilters Examples:</span><font face=""><span style="font-size: 14.0pt; font-family: Arial">&nbsp;</span></font></b><font face=""></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">T</span></font><span class="auto-style2">his 
		code below will filter a list starting in cell A1 on Sheet1 to display 
		only the entries in which field 1 is equal to the string &quot;AMSEA&quot;. The 
		drop-down arrow for field 1 will be hidden.&nbsp;</span></p>
		<font face="">
		<p style="font-family: Courier New; margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style10">
		<span style="color: #CC3300" class="auto-style6">Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).AutoFilter 
		field:=1, Criteria1:=&quot;AMSIA&quot;, _<br>
		&nbsp; VisibleDropDown:=False</span><span class="auto-style6">&nbsp; &nbsp;</span><span style="color: #339966" class="auto-style6">&#8216; 
		hide the AutoFilter drop-down arrow. To unhide, set it to True</span></p>
		<p class="auto-style16">
		&nbsp;</p>
		<p class="auto-style17">
		<br>
		<br>
		The following example sets the variable 
		&#8216;c1&#8217; to the value of the <b>Criteria1</b> property of the filter for the 
		first column in the filtered range on sheet1.</p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">With Worksheets(&quot;sheet1&quot;)</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">&nbsp;&nbsp;&nbsp; If .AutoFilterMode Then</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With .AutoFilter.Filters(1)</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If .On Then c1 = .Criteria1</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">&nbsp;&nbsp;&nbsp; End If</span></p>
		<p style="margin-left: 0in; margin-right: 0in; margin-top: 0in; margin-bottom: .0001pt" class="auto-style2">
		<span style="color: #CC3300">End With</span></p>
		<p><span class="auto-style6"><br class="auto-style10">
		</span><span class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span class="auto-style2">For this example, you must first make sure that all 
		filters are off. It uses &#8220;IF...Then&#8221; statement to display the current 
		status of the <b>AutoFilterMode</b> property on your active sheet. 
		If the AutoFilterMode property is True, the next code would disactivate 
		the AutoFilter in your active sheet.<br>
		</span>
		<span style="color: #CC3300" class="auto-style2">
		If ActiveSheet.AutoFilterMode = True Then<br>
		&nbsp;&nbsp; Selection.AutoFilter&nbsp;&nbsp;&nbsp; </span>
		<span style="color: #339966" class="auto-style2">
		' or 
		use ActiveSheet.AutoFilterMode = False<br>
		</span>
		<span style="color: #CC3300" class="auto-style2">
		&nbsp;&nbsp;&nbsp;&nbsp; If ActiveSheet.FilterMode = True Then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.ShowAllData<br>
		&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
		&nbsp;End If<br>
		</span><span style="color: #CC3300" class="auto-style6">
		<br class="auto-style10">
		<br class="auto-style10">
		</span><br class="auto-style2">
		<span class="auto-style2">This 
		example filters column A for unique values and copy to one after the 
		last column on the same worksheet.<br>
		</span>
		<span style="color: #CC3300" class="auto-style2">
		Dim LastRowcell As Range, LastColCell As Range<br>
		Set LastRowcell = Cells.Find(&quot;*&quot;, , , , xlByRows, xlPrevious)<br>
		Set LastColCell = Cells.Find(&quot;*&quot;, , , , xlByColumns, xlPrevious)<br>
		If Not LastRowcell Is Nothing Then<br>
		&nbsp;&nbsp; Range(Cells(1, 1), Cells(LastRowcell.Row, 1)).AdvancedFilter _<br>
		&nbsp;&nbsp; Action:=xlFilterCopy, CopyToRange:=Cells(1, LastColCell.Column + 1), 
		_<br>
		&nbsp;&nbsp; Unique:=True<br>
		End If</span></p>
		<p><span class="auto-style6"><br class="auto-style10">
		<br class="auto-style10">
		</span>
		<font face="">
		<span class="auto-style2">Input this Event 
		procedure in Sheet1. In this example, the Part Numbers are located in 
		Column A in both Sheet1 and Sheet2, but in column B in Sheet3. With reference to the Part Number in 
		Sheet1, and you want to check the shipping detail of the specific part number in Sheet2 
		and its unit selling price in Sheet3. Simply double-click any part number in 
		Sheet1, it will bring you to where you want to see.
		<a href="Sub_VBA/autofilter1.xls">DOWNLOAD</a> worksheet example here.<span style="color: #339966"><br>
		</span></span>
		<span style="color: #CC3300" class="auto-style2">
		Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As 
		Boolean)<br>
		Dim cellSEL<br>
		If ActiveCell.Column = 1 Then<br>
&nbsp;&nbsp; cellSEL = ActiveCell.Value<br>
&nbsp;&nbsp; Sheets(&quot;Sheet2&quot;).Select<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ActiveSheet.AutoFilterMode = False Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
		<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not IsNumeric(Right(cellSEL, 1)) Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter Field:=1, 
		Criteria1:=&quot;=*&quot; &amp; Mid(cellSEL, 1, Len(cellSEL) - 1) &amp; &quot;*&quot;, Operator:=xlAnd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter Field:=1, 
		Criteria1:=&quot;=*&quot; &amp; cellSEL &amp; &quot;*&quot;, Operator:=xlAnd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
		<br>
&nbsp;&nbsp; Sheets(&quot;Sheet3&quot;).Select<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ActiveSheet.AutoFilterMode = False Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
		<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not IsNumeric(Right(cellSEL, 1)) Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter Field:=2, 
		Criteria1:=&quot;=*&quot; &amp; Mid(cellSEL, 1, Len(cellSEL) - 1) &amp; &quot;*&quot;, Operator:=xlAnd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Selection.AutoFilter Field:=2, 
		Criteria1:=&quot;=*&quot; &amp; cellSEL &amp; &quot;*&quot;, Operator:=xlAnd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>
		End If<br>
		End Sub</span></p>
		<p>&nbsp;</p>
		</font></font></font>
		<p><b><span class="auto-style15">AdvancedFilter Method</span><span style="font-size: 18.0pt"><font face=""><br>
		</font>
		</span></b>
		<font face="">
		<font face="">
		<font face="">
		<span style="font-size: 10.0pt; font-family: Arial"><br>
		</span></font></font></font><span class="auto-style2">It filters or copies data from a list based on a criteria range. If the 
		initial selection is a single cell, that cell's current region is used. 
		The syntax is:</span></p>
		<font face="">
		<p class="auto-style18">expression.AdvancedFilter(Action, CriteriaRange, CopyToRange, Unique)&nbsp;</p>
		<table class="MsoTableGrid" border="1" cellspacing="0" cellpadding="0" style="border-style: none; border-color: inherit; border-width: medium; border-collapse: collapse; margin-left: 5.4pt; width: 691px;" id="table7">
			<tr>
				<td width="125" valign="top" style="width: 1.3in; " class="auto-style11">
				expression</td>
				<td width="482" valign="top" style="width: 361.8pt; " class="auto-style20">
				Required. An 
				expression that returns one of the objects in the Applies To 
				list.</td>
			</tr>
			<tr>
				<td width="125" valign="top" style="width: 1.3in; " class="auto-style12">
				Action</td>
				<td width="482" valign="top" style="width: 361.8pt; border-left: medium none; border-right: 1.0pt solid windowtext; border-top: medium none; border-bottom: 1.0pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in">
				<span class="auto-style2">Required 
				XlFilterAction. can be one of these constants: </span>
				<p class="auto-style2">xlFilterCopy </p>
				<p class="auto-style2">xlFilterInPlace</td>
			</tr>
			<tr>
				<td width="125" valign="top" style="width: 1.3in; " class="auto-style12">
				CriteriaRange</td>
				<td width="482" valign="top" style="width: 361.8pt; " class="auto-style13">
				Optional 
				Variant. The criteria range. If this argument is omitted, there 
				are no criteria.</td>
			</tr>
			<tr>
				<td width="125" valign="top" style="width: 1.3in; " class="auto-style12">
				CopyToRange</td>
				<td width="482" valign="top" style="width: 361.8pt; " class="auto-style13">
				Optional 
				Variant. The destination range for the copied rows if Action is 
				xlFilterCopy. Otherwise, this argument is ignored.</td>
			</tr>
			<tr>
				<td width="125" valign="top" style="width: 1.3in; " class="auto-style12">
				Unique</td>
				<td width="482" valign="top" style="width: 361.8pt; " class="auto-style13">
				Optional 
				Variant. True to filter unique records only. False to filter all 
				records that meet the criteria. The default value is False.</td>
			</tr>
		</table>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Courier New; color: #CC3300">
		<br>
		</span></b><span style="font-size: 10.0pt; font-family: Arial">T</span></font><span class="auto-style2">his 
		diagram below is the AdvancedFilter dialog box as what you would see 
		from the Excel User interface.</span></p>
		<font face="">
		<p>
		<img border="0" src="Images/AdvancedFilter_dialogbox.gif" width="249" height="242"></p>
		<p>&nbsp;</p>
		<p class="auto-style2">
		One of the useful 
		features of AdvancedFilter is able to extract a unique list of one field 
		from a range of dataset. The example shows how to obtain a unique list 
		of Part Numbers from a dataset, knowing that Part Number is in column C. 
		Of course, you should use Find method to locate C1 s ActiveCell so as 
		not to hardcode it, but for this example, let&#8217;s bear with hardcoding C1. 
		The unique list is copied to the last column but offset by 2, sort by 
		ascending order. Add a header and calculate using R1C1 style formula, 
		which is the equivalent of spreadsheet array function as &#8220;=sumproduct(($C$2:$D$30=F2)*($D$2:$D$30))&#8221;. 
		Then it copies the array formula to all blank cells in column G (until 
		the row in column F where unique list is blank). Diagram below is the exact output of what you should be seeing after this 
		procedure is run. You can <a href="Sub_VBA/advancedfilter1.xls">DOWNLOAD</a> 
		the worksheet example.</p>
		<p class="auto-style22">
		Sub GetUniqueList_AdvFilter()<br>
		Dim inRng As Range, outRng As Range<br>
		Dim finalrow As Long, finalcolumn2ToRight As Long<br>
		Dim finalrowUnq As Long, finalrowUnq2 As Long&nbsp;</p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' 
		Identify size of dataset</span></font><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">finalrow = Cells(65536, 1).End(xlUp).Row<br>
		finalcolumn2ToRight = Cells(1, 255).End(xlToLeft).Offset(, 2).Column</span></p>
		<p class="auto-style23">
		' Copy C1 
		heading to last cell in row 1, offset by 2 columns to the Right<br>
		&#8216; In a non-static user environment, you would want this value to be 
		passed from input box or userform such as:<br>
		&#8216; i = InputBox(&quot;Enter the header address you want to be copied to&quot;)<br>
		&#8216; Then use this line Range(i).Copy Destination:=Cells(1, 
		finalcolumn2ToRight)</p>
		<p class="auto-style22">
		Range(&quot;C1&quot;).Copy Destination:=Cells(1, finalcolumn2ToRight)&nbsp;</p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Define 
		output range and input range</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Set outRng = Cells(1, finalcolumn2ToRight)<br>
		Set inRng = Range(&quot;C1&quot;).Resize(finalrow, finalcolumn2ToRight - 2)</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Use 
		AdvancedFilter to obtain the unique Part Numbers list.<br>
		It could also be written as inRng.AdvancedFilter xlFilterCopy, outRng, 
		True</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">inRng.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=outRng, 
		unique:=True</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' 
		Identify number of unique part numbers</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">finalrowUnq = Cells(65536, finalcolumn2ToRight).End(xlUp).Row</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Sort 
		the the unique dataset</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Cells(1, finalcolumn2ToRight).Resize(finalrowUnq, 1).Sort key1:=Cells(1, 
		_<br>
		&nbsp; finalcolumn2ToRight), order1:=xlAscending, header:=xlYes</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Give a 
		header title</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Cells(1, finalcolumn2ToRight + 1).Value = &quot;Total stock on-hand $&quot;</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Add an 
		array formula to get the Totals.<br>
		' Excel spreadsheet equivalent is &nbsp;=SUMPRODUCT(($C$2:$D$30=F2)*($D$2:$D$30))</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Cells(2, finalcolumn2ToRight + 1).FormulaArray = _<br>
		&nbsp; &quot;=sumproduct((R2C3:R&quot; &amp; finalrow &amp; &quot;C4=RC[-1])*(R2C4:R&quot; &amp; finalrow &amp; 
		&quot;C4))&quot;</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Copy 
		array formula to all blank cells in column G (until the row in column F 
		where unique list is blank)</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Cells(2, finalcolumn2ToRight + 1).Copy Cells(3, finalcolumn2ToRight + 1) 
		_<br>
		&nbsp; .Resize(finalrowUnq - 2, 1)</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Format 
		a range</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Range(&quot;IV1&quot;).End(xlToLeft).Offset(1, 0).Select<br>
		Range(ActiveCell, ActiveCell.End(xlDown)).Rows.Select<br>
		With Selection<br>
		&nbsp;&nbsp;&nbsp; .Font.Size = 10<br>
		&nbsp;&nbsp;&nbsp; .Font.ColorIndex = 3<br>
		&nbsp;&nbsp;&nbsp; .Font.Bold = True<br>
		&nbsp;&nbsp;&nbsp; .NumberFormat = &quot;$#,##0.0&quot;<br>
		End With</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">' Sort by 
		Total stock on-hand $ in descending order</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">finalrowUnq2 = Cells(65536, ActiveCell.Column).End(xlUp).Row<br>
		Rows(&quot;1:1&quot;).Find(What:=&quot;$&quot;, SearchDirection:=xlNext).Activate<br>
		ActiveCell.Offset(, -1).Resize(finalrowUnq2, 2).Select<br>
		Selection.Sort Key1:=ActiveSheet.Rows(&quot;1:1&quot;).Find(What:=&quot;$&quot;, _<br>
		&nbsp; SearchDirection:=xlNext), Order1:=xlDescending, Orientation:=xlTopToBottom<br>
		End Sub</span></p>
		<p class="MsoNormal">
		<span style="color: #CC3300" class="auto-style2">
		<br>
		</span><span class="auto-style2">From the 
		above code, in fact you would notice that the key in extracting a unique 
		list is to copy the header in C1 to a blank cell F1, and set this blank 
		cell address as output range. Thus you can simplify a part of your code 
		like below.</span></p>
		<p class="auto-style22">
		Range(&quot;F1&quot;).Value = Range(&quot;C1&quot;).Value<br>
		Range(&quot;C1&quot;).Resize(finalrow, finalcolumn2ToRight - 2).AdvancedFilter 
		xlFilterCopy, CopyToRange:=Range(&quot;F1&quot;), unique:=True</p>
		<p class="MsoNormal">
		<img border="0" src="Images/advancedfilter1.gif" width="430" height="202"></p>
		<p>&nbsp;</p>
		</font></font></font></font></font></font></font></font></font></font>
		<p class="MsoNormal"><b>
		<span class="auto-style24"><br class="auto-style6">
		</span>
		<font face="">
		<span class="auto-style15">A note on the <i>NumberFormat</i> Property</span></font></b><font face=""></p>
		<p class="auto-style2">This property 
		applies to the DataLabel, DataLabels, PivotField, Style, and TickLabels 
		objects. For the PivotField object, you can set the NumberFormat 
		property only for a Data area field. Take note that the <b>Format</b> 
		function uses different format code strings than do the <b>NumberFormat</b> 
		and <b>NumberFormatLocal</b> properties.</p>
		<p class="auto-style2">These examples below set the number format for cell A2:A1000, column 2, 
		and column C to F on Sheet1.</p>
		<p class="auto-style22">
		Worksheets(&quot;Sheet1&quot;).Range(&quot;A2:A1000&quot;).NumberFormat = &quot;General&quot;<br>
		Worksheets(&quot;Sheet1&quot;).Columns(2).NumberFormat = &quot;hh:mm:ss&quot;</p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">&#8216; Shows 
		number format in red font and in parenthesis</span></font><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Worksheets(&quot;Sheet1&quot;).Columns(&quot;C&quot;).NumberFormat = 
		&quot;$#,##0.00_);[Red]($#,##0.00)&quot;</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">&#8216; Use a 
		single comma and include &#8220;K&#8221; character suffix to indicate numbers are in 
		thousands, eg. $12,345.6K</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Worksheets(&quot;Sheet1&quot;).Columns(&quot;C&quot;).NumberFormat = &quot;$#,##0.0,K&quot;</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">&#8216; Prefix 
		the &#8220;M&#8221; character with a backlash. &#8220;M&#8221; indicates numbers in millions, eg. 
		123.45678 thus becomes $123.456M</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Worksheets(&quot;Sheet1&quot;).Columns(&quot;C&quot;).NumberFormat = &quot;$#,##0.000 \M&quot;</span></p>
		<p class="MsoNormal">
		<span style="color:#339966" class="auto-style2">&#8216; Shows 
		the number format in billions, eg. 1234567 thus becomes $1.23B</span><span style="color: #CC3300" class="auto-style10"><br class="auto-style6">
		</span>
		<font face="">
		<span style="color: #CC3300" class="auto-style2">Worksheets(&quot;Sheet1&quot;).Columns(&quot;C&quot;).NumberFormat = &quot;$#,##0.00,,&quot;&quot;B&quot;&quot;&quot;</span></p>
		<p class="MsoNormal">
		<span class="auto-style6"></p>
		<p></span></p>

<p style='margin-left:6.5in' class="auto-style2">
<a href="#TOP" style="color: blue; text-decoration: underline; text-underline: single">
Return To Top</a></p></td>
</tr>

<font face="">

</tbody></table>


<table border="0" width="98%" id="table5" class="auto-style2">
<tr>
<td align="center">
This site was created in Feb.2007<br>by William Tan <br></td>
</tr>
</table>

</body>
<!-- Mirrored from vbautomation.110mb.com/VBA/autofilter.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:53:00 GMT -->
</html>