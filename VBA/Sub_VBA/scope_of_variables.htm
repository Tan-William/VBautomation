<html>


<!-- Mirrored from vbautomation.110mb.com/VBA/Sub_VBA/scope_of_variables.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:53:45 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Scope of Variables</title>
<style>
<!--
 p.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	margin-left:0in; margin-right:0in; margin-top:0in}
-->
</style>
</head>

<body>

<p class="MsoNormal"><span style="font-size: 13.5pt; font-family: Arial">Scope 
of Variables<br>
&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">This 
section shows you the important concept of the scope of variables with an 
example, or technically “which parts of a program have access to which other 
parts?”</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">You 
have learned in previous example how to declare a variable with a <b>Dim</b> 
statement and here is another example.<br>
(You can also <span style="color: blue"><a href="scope_of_variables.xls">
download</a></span> the worksheet). When a variable such as MySalary is declared 
within a Sub, it is called <b>procedure-level</b> variable or <b>local variable</b>.</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Sub Test_1()</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim MySalary as 
Currency</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MySalary = 7000</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">End Sub&nbsp;</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Sub Test_2()</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; MsgBox &quot;My monthly 
salary is &quot; &amp; MySalary</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">End Sub</span></font></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">When 
you run Test_2, the message box does not display “My monthly salary is 7000”. 
Test_2 has no memory that MySalary was 7000 in Test_1. This is because only Sub 
Test_1 that contains the variable MySalary recognizes it. Since Test_2 does not 
know the value of MySalary variable in Test_1, Test_2 can have its own MySalary 
variable. Now you create it in Test_3. You see that Test_3 knows only that its 
own created salary variable, defined as 8000.</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Sub Test_3()</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; Dim MySalary As Currency</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; MySalary = 8000</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; MsgBox &quot;My monthly 
salary is &quot; &amp; MySalary</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">End Sub</span></font></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">To 
conclude, local variables in different Subs can have the same names, but they 
have different memory locations. In another word, several Sub procedures can 
have a variable called MySalary, but because every variable is local to its 
procedure they all lead independently of each other and can different values.</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">What if 
you want different Sub procedures to have access to common variables? You can 
declare these variables <i>at the top of a module, before any subs</i>. You have 
2 choices by either declaring at the top of a module with the <b>Dim</b> keyword 
(an alternative to Dim is the <b>Private</b> keyword) or the <b>Public</b> 
keyword. </span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Dim MySalary as Currency or 
Private MySalary as Currency</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Public MySalary as Currency</span></font></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">The 
variable with Dim or Private keyword is a <b>module-level</b> variable, which 
means that every sub in the module has access to the variable MySalary. The 
variable with Public keyword is a <b>global-level</b> variable (or called public 
variable), which means that all modules in the entire project have access to the 
variable MySalary. A global variable has project-level scope.</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">If you 
declare a variable to have module-level or project-level scope, you should not 
declare the same variable inside a sub with a Dim statement as in the next 
example. If run Test_6, the message box will not display &quot;My monthly salary is 
7000”, but it will display &quot;My monthly salary is 0”. This is because the Dim 
statement in Test_6 creates its local version of MySalary that overrides the 
public version. This local version is initialized to 0 by default.</span></p>
<p class="MsoNormal"><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Public MySalary As Currency</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Sub Test_5()</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; MySalary = 7000</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">End Sub</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">Sub Test_6()</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; Dim MySalary As Currency</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;&nbsp; MsgBox &quot;My monthly 
salary is &quot; &amp; MySalary</span></font></p>
<p class="MsoNormal"><font color="#008000">
<span style="font-size: 10.0pt; font-family: Arial">End Sub</span></font></p>

</body>


<!-- Mirrored from vbautomation.110mb.com/VBA/Sub_VBA/scope_of_variables.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:53:46 GMT -->
</html>
