<html>


<!-- Mirrored from vbautomation.110mb.com/EXCEL/Samples/SQL.REQUEST.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:53:49 GMT -->
<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>SQL</title>
<style>
<!--
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	}
 p.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	margin-left:0in; margin-right:0in; margin-top:0in}
span.acicollapsed1
	{}
 table.MsoNormalTable
	{mso-style-parent:"";
	font-size:10.0pt;
	font-family:"Times New Roman";
	}
-->
</style>
</head>

<body>

<table border="0" width="91%" cellspacing="0" cellpadding="0" id="table3">
	<tr>
		<td width="43">&nbsp;</td>
		<td>
		<p class="MsoNormal"><span style="font-family: Arial; font-weight: 700">
		<font size="5">SQL.REQUEST</font></span><span style="font-size: 13.5pt; font-family: Arial; color: #666666">&nbsp;</span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">Some of the 
		content in this topic may not be applicable to some languages.</span></p>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; text-transform: uppercase; border: 1.0pt solid #ABBFE0; padding: 0in; background: white">
		&nbsp;Important&nbsp;</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp;The 
		SQL.REQUEST function is not supported in Microsoft Office Excel 2003 
		because the Excel 2002 <b>Add-in: Open Database Connectivity</b> <b>(XLODBC.XLA</b>) 
		is only supported in Excel 2002. </span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">SQL.REQUEST 
		connects with an external data source, and runs a query from a 
		worksheet. SQL.REQUEST then returns the result as an array without the 
		need for macro programming. If this function is not available, you must 
		install the Microsoft Excel <b>ODBC
		<a style="color: #0560A6; text-decoration: none; text-underline: none; text-line-through: none" href="javascript:AppendPopup(this,'ofAddIn_1')">
		<span style="color: windowtext">add-in program<span class="acicollapsed1"><span style="display: none" id="divInlineDef_ofAddIn_2">&nbsp;(add-in: 
		A supplemental program that adds custom commands or custom features to 
		Microsoft Office.)</span></span></span></a></b> (<b>XLODBC.XLA</b>). You 
		can install the add-in from the Microsoft Office Web site.</span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">Syntax:</span></p>
		<p><b><span style="font-family: Courier New; color: maroon">
		<font size="2">SQL.REQUEST</font></span></b><font face="Courier New" size="2"><span style="color: maroon">(<b>connection_string</b>,output_ref,driver_prompt,<b>query_text</b>,col_names_logical</span></font><font face="Courier New" size="2"><span style="color: maroon">)</span></font></p>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		Connection_string</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp; 
		supplies information, such as the <span style="color: #3366FF">data 
		source name</span>, user ID, and passwords, required by the driver being 
		used to connect to a data source and must follow the driver's format. 
		The following table provides three example connection strings for three 
		drivers.</span></p>
		<table class="MsoNormalTable" border="0" cellpadding="0" style="margin-left: 7.5pt" id="table6">
			<tr>
				<td width="97" valign="top" style="width: 72.55pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<b>
				<span style="font-size: 10.0pt; font-family: Arial; text-decoration: underline">
				Driver</span></b></td>
				<td width="496" valign="top" style="width: 371.75pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<b>
				<span style="font-size: 10.0pt; font-family: Arial; text-decoration: underline">
				Connection_string</span></b></td>
			</tr>
			<tr>
				<td width="97" valign="top" style="width: 72.55pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<span style="font-size: 10.0pt; font-family: Arial">dBASE</span></td>
				<td width="496" valign="top" style="width: 371.75pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<font color="#800000">
				<span style="font-size: 10.0pt; font-family: Courier New">DSN=NWind;PWD=durian</span></font></td>
			</tr>
			<tr>
				<td width="97" valign="top" style="width: 72.55pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<span style="font-size: 10.0pt; font-family: Arial">SQL Server</span></td>
				<td width="496" valign="top" style="width: 371.75pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<font color="#800000">
				<span style="font-size: 10.0pt; font-family: Courier New">DSN=MyServer;UID=E91128; 
				PWD=durian;Database=sharedata</span></font></td>
			</tr>
			<tr>
				<td width="97" valign="top" style="width: 72.55pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<span style="font-size: 10.0pt; font-family: Arial">ORACLE</span></td>
				<td width="496" valign="top" style="width: 371.75pt; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<font color="#800000">
				<span style="font-size: 10.0pt; font-family: Courier New">DNS=MyOracleServer;DBQ=MYSER 
				VER;UID= ptan91128;PWD=durian</span></font></td>
			</tr>
		</table>
		<p><span style="font-size: 10.0pt; font-family: Arial">You must define 
		the <span style="color: #3366FF">data source name</span> (<b>DSN</b>) 
		used in connection_string before you try to connect to it. </span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">You can enter 
		connection_string as an array or a string. If connection_string exceeds 
		250 characters, you must enter it as an array. </span></p>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		Output_ref</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp; 
		is a cell reference where you want the completed connection string 
		placed. If you enter SQL.REQUEST on a worksheet, then output_ref is 
		ignored.</span></p>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		Driver_prompt</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp; 
		specifies when the driver dialog box is displayed and which options are 
		available. Use one of the numbers described in the following table. If 
		driver_prompt is omitted, SQL.REQUEST uses 2 as the default.</span></p>
		<table class="MsoNormalTable" border="1" style="margin-left: 7.5pt" id="table7" cellspacing="1" bordercolor="#C0C0C0" width="720">
			<tr>
				<td valign="top" style="width: 90px; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<b><span style="font-size: 10.0pt; font-family: Arial">
				Driver_prompt</span></b></td>
				<td valign="top" style="padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<p align="center"><b>
				<span style="font-size: 10.0pt; font-family: Arial">Description</span></b></td>
			</tr>
			<tr>
				<td valign="top" style="width: 90px; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<p align="center" style="text-align: center">
				<span style="font-size: 10.0pt; font-family: Arial">1</span></td>
				<td valign="top" style="padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<span style="font-size: 10.0pt; font-family: Arial">Driver 
				dialog box is always displayed.</span></td>
			</tr>
			<tr>
				<td valign="top" style="width: 90px; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<p align="center" style="text-align: center">
				<span style="font-size: 10.0pt; font-family: Arial">2</span></td>
				<td valign="top" style="padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<span style="font-size: 10.0pt; font-family: Arial">Driver 
				dialog box is displayed only if information provided by the 
				connection string and the data source specification is not 
				sufficient to complete the connection. All dialog box options 
				are available.</span></td>
			</tr>
			<tr>
				<td valign="top" style="width: 90px; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<p align="center" style="text-align: center">
				<span style="font-size: 10.0pt; font-family: Arial">3</span></td>
				<td valign="top" style="padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt">
				<span style="font-size: 10.0pt; font-family: Arial">Driver 
				dialog box is displayed only if information provided by the 
				connection string and the data source specification is not 
				sufficient to complete the connection. Dialog box options appear 
				dimmed and unavailable if they are not required.</span></td>
			</tr>
			<tr>
				<td valign="top" style="width: 90px; padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<p align="center" style="text-align: center">
				<span style="font-size: 10.0pt; font-family: Arial">4</span></td>
				<td valign="top" style="padding-left: 6.0pt; padding-right: 6.0pt; padding-top: 3.0pt; padding-bottom: 3.0pt; background: #F2F2F2">
				<span style="font-size: 10.0pt; font-family: Arial">Driver 
				dialog box is not displayed. If the connection is not 
				successful, it returns an error.</span></td>
			</tr>
		</table>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		Query_text</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp; 
		is the SQL statement that you want to execute on the data source.</span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">You can update a 
		query by concatenating references into query_text. In the following 
		example, every time $A$2 changes, SQL.REQUEST uses the new value to 
		update the query. </span></p>
		<p><code style="font-family: Courier New">
		<span style="font-size: 10.0pt; color: maroon">&quot;SELECT Material FROM 
		Inventory WHERE Cost &gt; &quot;&amp;$A$2&amp;&quot;&quot;</span></code></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">Excel limits 
		strings to a length of 255 characters. If query_text exceeds that 
		length, enter the query in a vertical range of cells, and use the entire 
		range as the query_text. The values of the cells are concatenated to 
		form the complete SQL statement.</span></p>
		<p><b>
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		Column_names_logical</span></b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;&nbsp; 
		indicates whether column names are returned as the first row of the 
		results. Set this argument to TRUE if you want the column names to be 
		returned as the first row of the results. Use FALSE if you do not want 
		the column names returned. If column_names_logical is omitted, 
		SQL.REQUEST does not return column names.</span></p>
		<p><b><span style="font-size: 10.0pt; font-family: Arial">&nbsp;</span></b></p>
		<p><b><span style="font-size: 10.0pt; font-family: Arial">Returning the 
		value</span></b></p>
		<p><font size="2"><b><span style="font-family: Arial">&gt;&gt; </span></b>
		</font>
		<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; font-family: Times New Roman">&nbsp; 
		&nbsp;</span><span style="font-size: 10.0pt; font-family: Arial">If this 
		function completes all of its actions, it returns an array of query 
		results or the number of rows affected by the query.</span></p>
		<p><font size="2"><span style="font-family: Arial">&gt;&gt;&nbsp; </span>
		</font>
		<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; font-family: Times New Roman">&nbsp;</span><span style="font-size: 10.0pt; font-family: Arial">If 
		SQL.REQUEST is unable to access the data source using connection_string, 
		it returns the #N/A error value. </span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial"><br>
		<b>Remarks</b></span></p>
		<p><font size="2"><b><span style="font-family: Arial">&gt;&gt;</span></b></font><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; font-family: Times New Roman">&nbsp;&nbsp;
		</span><span style="font-size: 10.0pt; font-family: Arial">SQL.REQUEST 
		can be entered as an array. When you enter SQL.REQUEST as an array, it 
		returns an array to fit that range.</span></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">&gt;&gt;&nbsp; If the 
		range of cells is larger than the result set, SQL.REQUEST adds empty 
		cells to the returned array to increase it to the necessary size. </span>
		</p>
		<p><font size="2"><b><span style="font-family: Arial">&gt;&gt; </span></b>
		</font>
		<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; font-family: Times New Roman">&nbsp;&nbsp;</span><span style="font-size: 10.0pt; font-family: Arial">If 
		the result set is larger than the range entered as an array, SQL.REQUEST 
		returns the whole array.</span></p>
		<p><font size="2"><b><span style="font-family: Arial">&gt;&gt;</span></b></font><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; font-family: Times New Roman">&nbsp;&nbsp;
		</span><span style="font-size: 10.0pt; font-family: Arial">The arguments 
		to SQL.REQUEST are in a different order than the arguments to the 
		SQLRequest function in Visual Basic for Applications.</span></p>
		<p><b><span style="font-size: 10.0pt; font-family: Arial"><br>
		Example</span></b></p>
		<p><span style="font-size: 10.0pt; font-family: Arial">Suppose you want 
		to make a query of a SQL Server database named DBASE4. When you enter 
		the following formula in a cell, an array of query results is returned, 
		with the first row being the column names:</span></p>
		<p><code style="font-family: Courier New">
		<span style="font-size: 10.0pt; font-family: Arial; color: maroon">
		SQL.REQUEST(&quot;DSN=</span></code><span style="color: maroon"> MyServer</span><code style="font-family: Courier New"><span style="font-size: 10.0pt; font-family: Arial; color: maroon">;DBQ=F:\Planning\msquery;FIL=</span></code><span style="color: maroon"> 
		sharedata</span><code style="font-family: Courier New"><span style="font-size: 10.0pt; font-family: Arial; color: maroon">&quot;, 
		A15, 2, &quot;SELECT Material FROM Inventory WHERE Cost &gt; &quot;&amp;$A$2&amp;&quot;, TRUE)</span></code></td>
	</tr>
</table>

</body>


<!-- Mirrored from vbautomation.110mb.com/EXCEL/Samples/SQL.REQUEST.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 21 Dec 2008 07:53:49 GMT -->
</html>
