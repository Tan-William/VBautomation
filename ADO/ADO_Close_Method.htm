<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<a name=TOP></a>
<base target="_new">
<style>
<!--
.new_link {color: #000000;  font-family: Verdana, Arial, Helvetica, sans-serif;   font-size: 11px; text-decoration: none; font-weight: normal;}
-->
</style>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>ADO Close Method</title>
<meta name="author" content="William Poh Beng, http://vbautomation.110mb.com">
<meta name="description" content="Access Macros. Access Visual Basic. Access ADO. Access ADOX. Jet SQL. Access tutorial">
<meta name="keywords" content="Access Macros. Access Visual Basic. Access ADO. Access AOX. Jet SQL. Access tutorial. Access Help">
<meta name="generator" content="Microsoft FrontPage 6.0">


<style type="text/css">
body {scrollbar-3dlight-color:#000000;
scrollbar-arrow-color:#FFFFFF;
scrollbar-base-color:#ffffff;
scrollbar-darkshadow-color:#000000;
scrollbar-face-color:#660000;
scrollbar-highlight-color:#ffffff;
scrollbar-shadow-color:#ffffff}
</style>

<style>
	table.includes {border-top:1px solid #ccc}
	table.includes td {font:normal 11px sans-serif; border-bottom: 1px solid #ccc; padding:10px}
	a {color: #0033FF}
	a:hover {color:#660000}
	h1 {font-size:12px; margin:0 0 5px 0}
	ul.list {list-style-image: url(''); padding:0; margin-left:15px; margin-right:0; margin-top:0; margin-bottom:0}
	ul.list li {margin: 2px 0;}
</style>


<style>
	table.bottom_links {margin:10px 0px}
	table.bottom_links td {padding:3px}
</style>



<body>
<div align="left">
<table border="0" width="99%" cellspacing="0" cellpadding="0" height="10%" background="../../YellowTexture.gif">
	<tr>
	<td height="" align="center" valign="bottom">
	<p align="center"><font face="Verdana" style="font-size: 80%">
	<a style="text-decoration: none" href="../../index.htm">Home</a>&nbsp;|
	<a style="text-decoration: none" href="../../AboutMe/Me.htm">About me</a> |
	<a style="text-decoration: none" href="../../VBA/beginner_basic.htm">EXCEL 
	VB Programming (XL97-2003)</a>&nbsp;|
	<a style="color: #800000; text-decoration: none" href="../beginner_basic_Acc.htm">
	ACCESS Programming</a>&nbsp;|
	<a style="text-decoration: none" href="../../EXCEL%20VB.Net/excel_vb.net_under_construction.htm">
	EXCEL VB.Net Programming</a>&nbsp;|
	<a style="text-decoration: none" href="../../EXCEL/excel_worksheet_functions.htm">
	EXCEL Spreadsheet Functions</a> |&nbsp;
	<a style="text-decoration: none" href="../../INVENTORY%20MGMT/index_inv_mgmt.htm">
	Material Management</a>&nbsp; |&nbsp;&nbsp;<a style="text-decoration: none" href="../../GUESTBOOK/gbook.html">Guestbook</a>
	<br>
	</font><font face="Verdana">&nbsp;</font></td>
	</tr>
	</table>
	</div>

	<div align="left">		
	<table border="0" width="99%" cellspacing="0" cellpadding="0" id="table3">
	<tr>
	<td>
		
		<h1><font size="6">ADO Close Method</font></h1>
<p>Closes an open object and any dependent objects.</p>
		<pre class="libCScode" style="white-space: pre-wrap;" id="ctl00_rs1_mainContentContainer_ctl03other" space="preserve"><font size="3" color="#800000">object.Close</font></pre>
		<p><font size="2">Applies To:<br>
		Connection Object (ADO)<br>
		Record Object (ADO)<br>
		Recordset Object (ADO)<br>
		Stream Object (ADO) </font></p>
		<p><font size="2">Remarks:<br>
		Use the Close method to close a Connection, a Record, a Recordset, or a 
		Stream object to free any associated system resources. Closing an object 
		does not remove it from memory; you can change its property settings and 
		open it again later. To completely eliminate an object from memory, 
		close the object and then set the object variable to Nothing (in Visual 
		Basic).</font></p>
		<p><b>Example</b>:</p>
		<pre class="libCScode" style="white-space: pre-wrap;" id="ctl00_rs1_mainContentContainer_ctl09other" space="preserve"><font color="#008000">' use the Open and Close methods on both Recordset and Connection objects that have been opened</font><font color="#800000">
Public Sub ADO_OpenMethod()
    On Error GoTo ErrorHandler

    Dim cnn As ADODB.Connection
    Dim rst As ADODB.Recordset
    Dim strCnn As String
    Dim strSQL As String
    Dim varDate As Variant
    
    </font><font color="#008000">' Open connection</font><font color="#800000">
    strCnn = </font><font color="#800000" size="2" face="Courier New">&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; &quot;Data Source=D:\MyData\Northwind.mdb&quot;</font><font color="#800000">
    Set cnn = New ADODB.Connection
    cnn.Open strCnn
    
    </font><font color="#008000">' Open employee table</font><font color="#800000">
    Set rst = New ADODB.Recordset
    strSQL = &quot;employee&quot;
    rst.Open strSQL, cnn, adOpenKeyset, adLockOptimistic, adCmdTable
    
    </font><font color="#008000">' Assign the first employee record's hire date to a variable, then change the hire date</font><font color="#800000">
    varDate = rst!hire_date
    Debug.Print &quot;Original data&quot;
    Debug.Print &quot;  Name - Hire Date&quot;
    Debug.Print &quot;  &quot; &amp; rst!fname &amp; &quot; &quot; &amp; _
        rst!lname &amp; &quot; - &quot; &amp; rst!hire_date
    rst!hire_date = #1/1/1900#
    rst.Update
    Debug.Print &quot;Changed data&quot;
    Debug.Print &quot;  Name - Hire Date&quot;
    Debug.Print &quot;  &quot; &amp; rst!fname &amp; &quot; &quot; &amp; _
        rst!lname &amp; &quot; - &quot; &amp; rst!hire_date
    
    </font><font color="#008000">' Requery Recordset and reset the hire date</font><font color="#800000">
    rst.Requery
    rst!hire_date = varDate
    rst.Update
    Debug.Print &quot;Data after reset&quot;
    Debug.Print &quot;  Name - Hire Date&quot;
    Debug.Print &quot;  &quot; &amp; rst!fname &amp; &quot; &quot; &amp; _
       rst!lname &amp; &quot; - &quot; &amp; rst!hire_date

    </font><font color="#008000">' clean up</font><font color="#800000">
    rst.Close
    cnn.Close
    Set rst = Nothing
    Set cnn = Nothing
    Exit Sub
    
ErrorHandler:
    </font><font color="#008000">' clean up</font><font color="#800000">
    If Not rst Is Nothing Then
        If rst.State = adStateOpen Then rst.Close
    End If
    Set rst = Nothing
    
    If Not cnn Is Nothing Then
        If cnn.State = adStateOpen Then cnn.Close
    End If
    Set cnn = Nothing
    
    If Err &lt;&gt; 0 Then
        MsgBox Err.Source &amp; &quot;--&gt;&quot; &amp; Err.Description, , &quot;Error&quot;
    End If
End Sub</font></pre>
	</td>
				</tr>
			</table>
			</div>
</body>
</head>		
</html>